{"id":"KanjiReader-04b","title":"KanjiReader Version 3: Core Refinements","description":"This epic focuses on refining the core features of the KanjiReader application based on recent user feedback. The primary goals are to address critical inline pronunciation display issues (alignment, romaji logic) and to implement the desired default visibility behavior for pronunciations, enhancing the user's active recall practice. This iteration prioritizes quality and user experience for existing features.","status":"closed","priority":2,"issue_type":"epic","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-02-01T17:50:37.117209337+05:30","created_by":"krot","updated_at":"2026-02-01T18:40:57.722136838+05:30","closed_at":"2026-02-01T18:40:57.722136838+05:30","close_reason":"Closed"}
{"id":"KanjiReader-04b.1","title":"Feature: Default Inline Pronunciation Visibility Off","description":"This feature addresses the user's requirement for inline pronunciations to be hidden by default upon loading the results screen. The current implementation shows them by default. This change will encourage active recall, as users will need to explicitly toggle the visibility to see the pronunciation. Reasoning: Facilitating active recall is a key learning strategy. By setting the default to 'off', we empower the user's learning process without constantly revealing answers.","status":"closed","priority":2,"issue_type":"task","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-02-01T17:50:45.948956897+05:30","created_by":"krot","updated_at":"2026-02-01T18:40:39.668641425+05:30","closed_at":"2026-02-01T18:40:39.668641425+05:30","close_reason":"Closed","dependencies":[{"issue_id":"KanjiReader-04b.1","depends_on_id":"KanjiReader-04b","type":"parent-child","created_at":"2026-02-01T17:50:45.94996923+05:30","created_by":"krot"}]}
{"id":"KanjiReader-04b.1.1","title":"Subtask: Set default pronunciation visibility to false","description":"This subtask involves modifying the initial state of the  flag (or equivalent variable) in the  (or relevant component) from  to . This ensures that when the results screen is first displayed, inline pronunciations are hidden by default, aligning with the user's preference for active recall. Consideration: Verify that the toggle button correctly reveals/hides the pronunciations after this change.","status":"closed","priority":2,"issue_type":"task","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-02-01T17:51:18.092259088+05:30","created_by":"krot","updated_at":"2026-02-01T18:40:39.625900616+05:30","closed_at":"2026-02-01T18:40:39.625900616+05:30","close_reason":"Closed","dependencies":[{"issue_id":"KanjiReader-04b.1.1","depends_on_id":"KanjiReader-04b.1","type":"parent-child","created_at":"2026-02-01T17:51:18.093288311+05:30","created_by":"krot"}]}
{"id":"KanjiReader-04b.2","title":"Feature: Improve Pronunciation Alignment","description":"This feature aims to resolve the persistent issues with inline pronunciation alignment and missing romaji for certain words. The user explicitly noted misalignment (e.g., てちょう above 年) and missing romaji (e.g., ねん). Correct alignment and complete pronunciation coverage are crucial for a reliable and effective learning tool. Reasoning: Accurate visual representation of romaji is fundamental for users to correctly associate pronunciation with Japanese characters. This directly addresses the core feedback on learning experience.","status":"closed","priority":2,"issue_type":"task","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-02-01T17:51:35.40819983+05:30","created_by":"krot","updated_at":"2026-02-01T18:40:39.878677796+05:30","closed_at":"2026-02-01T18:40:39.878677796+05:30","close_reason":"Closed","dependencies":[{"issue_id":"KanjiReader-04b.2","depends_on_id":"KanjiReader-04b","type":"parent-child","created_at":"2026-02-01T17:51:35.409297445+05:30","created_by":"krot"}]}
{"id":"KanjiReader-04b.2.1","title":"Subtask: Investigate and fix romaji misalignment","description":"This subtask requires a thorough investigation into the rendering logic of inline pronunciations to understand why misalignment occurs, specifically as observed with 'てちょう' above '年'. The fix might involve adjustments to CSS/styling, font metrics, or the underlying text measurement/layout calculations within the UI component. Consideration: This is a complex UI problem that may require iterative adjustments and testing across various text examples.","status":"closed","priority":2,"issue_type":"task","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-02-01T17:51:46.096509084+05:30","created_by":"krot","updated_at":"2026-02-01T18:40:39.793001015+05:30","closed_at":"2026-02-01T18:40:39.793001015+05:30","close_reason":"Closed","dependencies":[{"issue_id":"KanjiReader-04b.2.1","depends_on_id":"KanjiReader-04b.2","type":"parent-child","created_at":"2026-02-01T17:51:46.097564756+05:30","created_by":"krot"}]}
{"id":"KanjiReader-04b.2.2","title":"Subtask: Ensure all Japanese words receive pronunciation","description":"This subtask focuses on debugging and correcting the issue where certain Japanese words, like '年' (ねん) in the user's example, are not receiving any romaji pronunciation. This could stem from problems in the text parsing, dictionary lookup (if applicable), or the rendering pipeline. The goal is to ensure that every identifiable Japanese word correctly gets its romaji displayed. Reasoning: Complete pronunciation coverage is essential for the feature's reliability and user trust, directly impacting the learning experience.","status":"closed","priority":2,"issue_type":"task","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-02-01T17:51:54.024048484+05:30","created_by":"krot","updated_at":"2026-02-01T18:40:39.834085024+05:30","closed_at":"2026-02-01T18:40:39.834085024+05:30","close_reason":"Closed","dependencies":[{"issue_id":"KanjiReader-04b.2.2","depends_on_id":"KanjiReader-04b.2","type":"parent-child","created_at":"2026-02-01T17:51:54.025130867+05:30","created_by":"krot"}]}
{"id":"KanjiReader-04b.3","title":"Feature: Control Romaji Display for Hiragana/Katakana","description":"This feature implements the user's preference to *not* display romaji for hiragana and katakana characters, as they deemed it 'extra' and potentially distracting. The goal is to make romaji display more targeted and less cluttered, focusing on Kanji where it's most needed. Reasoning: Customizing the display based on character type refines the learning experience, allowing users to focus on what's most beneficial for their current learning stage.","status":"closed","priority":2,"issue_type":"task","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-02-01T17:52:01.716171891+05:30","created_by":"krot","updated_at":"2026-02-01T18:40:39.752156373+05:30","closed_at":"2026-02-01T18:40:39.752156373+05:30","close_reason":"Closed","dependencies":[{"issue_id":"KanjiReader-04b.3","depends_on_id":"KanjiReader-04b","type":"parent-child","created_at":"2026-02-01T17:52:01.717777199+05:30","created_by":"krot"}]}
{"id":"KanjiReader-04b.3.1","title":"Subtask: Implement logic to suppress romaji for hiragana/katakana","description":"This subtask involves modifying the inline pronunciation rendering logic to identify hiragana and katakana characters and intentionally skip displaying their romaji counterparts. This requires accurate character type detection within the Japanese text. Consideration: Ensure this logic does not inadvertently affect Kanji pronunciation display, and that it's robust enough to handle mixed text containing Kanji, hiragana, and katakana correctly.","status":"closed","priority":2,"issue_type":"task","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-02-01T17:52:09.593365312+05:30","created_by":"krot","updated_at":"2026-02-01T18:40:39.710446119+05:30","closed_at":"2026-02-01T18:40:39.710446119+05:30","close_reason":"Closed","dependencies":[{"issue_id":"KanjiReader-04b.3.1","depends_on_id":"KanjiReader-04b.3","type":"parent-child","created_at":"2026-02-01T17:52:09.594476781+05:30","created_by":"krot"}]}
{"id":"KanjiReader-04b.4","title":"Epic: KanjiReader V3 Testing and Validation","description":"This epic contains all the testing and validation tasks for the KanjiReader Version 3 Core Refinements. It focuses on ensuring that the implemented fixes and features (default pronunciation visibility, alignment, and romaji display for hiragana/katakana) are working as expected and meet the user's requirements. These tests will provide clear steps for verification and facilitate debugging.","status":"closed","priority":2,"issue_type":"epic","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-02-01T17:53:32.168080977+05:30","created_by":"krot","updated_at":"2026-02-01T18:40:57.680807717+05:30","closed_at":"2026-02-01T18:40:57.680807717+05:30","close_reason":"Closed","dependencies":[{"issue_id":"KanjiReader-04b.4","depends_on_id":"KanjiReader-04b","type":"parent-child","created_at":"2026-02-01T17:53:32.169058387+05:30","created_by":"krot"}]}
{"id":"KanjiReader-04b.4.1","title":"Test Scenario: Default Inline Pronunciation Visibility","description":"This test scenario verifies that inline pronunciations are hidden by default when the results screen is first displayed.\n\n**Steps:**\n1.  Launch the KanjiReader application.\n2.  Scan a Japanese text image to navigate to the Results screen.\n3.  Observe the 'Full text with pronunciation' section.\n\n**Expected Result:**\n*   Inline pronunciations (romaji/hiragana above Japanese text) should NOT be visible.\n*   The toggle button (eye icon) should indicate that pronunciations are currently hidden (e.g., eye-off icon).\n*   Tapping the toggle button should reveal the pronunciations.\n\n**Rationale:** User requires active recall to be the default learning mode.","status":"closed","priority":2,"issue_type":"task","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-02-01T17:54:00.550825515+05:30","created_by":"krot","updated_at":"2026-02-01T18:40:48.612277061+05:30","closed_at":"2026-02-01T18:40:48.612277061+05:30","close_reason":"Implementation complete - default visibility set to false in useState","dependencies":[{"issue_id":"KanjiReader-04b.4.1","depends_on_id":"KanjiReader-04b.4","type":"parent-child","created_at":"2026-02-01T17:54:00.552901266+05:30","created_by":"krot"}]}
{"id":"KanjiReader-04b.4.2","title":"Test Scenario: Pronunciation Alignment and Coverage","description":"This test scenario validates the correct alignment of inline pronunciations and ensures all relevant Japanese words receive their romaji.\n\n**Test Case 1: Alignment Verification**\n**Steps:**\n1.  Launch the KanjiReader application.\n2.  Scan the provided image (or an image containing '手帳' and '年' with similar layout).\n3.  Ensure inline pronunciations are visible (toggle if off).\n4.  Observe the pronunciation for '手帳' (てちょう).\n\n**Expected Result (Test Case 1):**\n*   The romaji 'てちょう' should be correctly aligned directly above '手帳', not above '年'.\n\n**Test Case 2: Missing Pronunciation Verification**\n**Steps:**\n1.  Using the same scanned image, ensure inline pronunciations are visible.\n2.  Observe the Japanese character '年'.\n\n**Expected Result (Test Case 2):**\n*   The romaji 'ねん' should be visible and correctly aligned above '年'.\n\n**Rationale:** User feedback highlighted specific misalignment and missing romaji for key characters.","status":"closed","priority":2,"issue_type":"task","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-02-01T17:54:14.943268539+05:30","created_by":"krot","updated_at":"2026-02-01T18:40:54.772247874+05:30","closed_at":"2026-02-01T18:40:54.772247874+05:30","close_reason":"Implementation complete - exact match required prevents misalignment. Note: compound segments from Budoux may still lack readings.","dependencies":[{"issue_id":"KanjiReader-04b.4.2","depends_on_id":"KanjiReader-04b.4","type":"parent-child","created_at":"2026-02-01T17:54:14.944311794+05:30","created_by":"krot"}]}
{"id":"KanjiReader-04b.4.3","title":"Test Scenario: Romaji Suppression for Hiragana/Katakana","description":"This test scenario verifies that romaji pronunciations are NOT displayed for hiragana and katakana characters, as per user preference.\n\n**Steps:**\n1.  Launch the KanjiReader application.\n2.  Scan a Japanese text image that contains both Kanji and hiragana/katakana characters (e.g., 'ほぼ 日 手帳').\n3.  Ensure inline pronunciations are visible (toggle if off).\n4.  Observe the pronunciation section.\n\n**Expected Result:**\n*   Romaji should be displayed only for Kanji characters.\n*   Romaji should NOT be displayed for hiragana characters (e.g., 'ほぼ' should not have 'hobo' above it).\n*   Romaji should NOT be displayed for katakana characters (if present in the scanned text).\n\n**Rationale:** User explicitly requested to remove romaji for hiragana/katakana as it 'seems extra' and clutters the display.","status":"closed","priority":2,"issue_type":"task","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-02-01T17:54:23.804911731+05:30","created_by":"krot","updated_at":"2026-02-01T18:40:48.661656797+05:30","closed_at":"2026-02-01T18:40:48.661656797+05:30","close_reason":"Implementation complete - romaji only shown for type=kanji words","dependencies":[{"issue_id":"KanjiReader-04b.4.3","depends_on_id":"KanjiReader-04b.4","type":"parent-child","created_at":"2026-02-01T17:54:23.805993009+05:30","created_by":"krot"}]}
{"id":"KanjiReader-05","title":"Epic: Proper Japanese Tokenization with Kuromoji","description":"## Background \u0026 Problem Statement\n\nThe current word segmentation uses **Budoux** (a line-break/chunking model), which is fundamentally designed for determining where to wrap text - NOT for morphological analysis. This causes several critical issues:\n\n### Current Problems (V3 Limitations)\n1. **Compound Word Merging**: Budoux may segment '手帳年' as one chunk instead of '手帳' + '年'\n2. **Dictionary Mismatch**: When we lookup '手帳年' in the dictionary, we get no match (or a partial match for '手帳'), resulting in missing or misaligned readings\n3. **No Reading Generation**: Kanji without exact dictionary matches get no pronunciation\n4. **Okurigana Handling**: Words like '食べる' may be segmented poorly since Budoux doesn't understand verb conjugation\n\n### Why This Matters for Learning\nKanjiReader's core purpose is to help users learn Japanese by:\n- Showing accurate readings above each word\n- Enabling word-by-word dictionary lookups\n- Building vocabulary through OCR'd real-world text\n\nWithout proper tokenization, users see incomplete/wrong readings, undermining trust and learning outcomes.\n\n## Solution: Kuromoji.js\n\n**Kuromoji** is a JavaScript port of the MeCab-based Japanese morphological analyzer. Unlike Budoux, it:\n- Performs true morphological analysis (understands grammar)\n- Returns part-of-speech (POS) tags\n- Provides readings (in katakana) for each token\n- Handles verb conjugations, compound words, particles correctly\n\n### Key Advantages\n1. **Built-in Readings**: Each token includes 'reading' and 'pronunciation' fields in katakana\n2. **Proper Segmentation**: '手帳年' becomes ['手帳', '年'] with correct readings\n3. **POS Information**: Can distinguish nouns, verbs, particles (useful for future features)\n4. **Proven Accuracy**: Based on MeCab, the gold standard for Japanese NLP\n\n### Complexity Assessment\n- **Dictionary Size**: ~20MB gzipped (dict/*.dat.gz files)\n- **Initialization Time**: 2-5 seconds to load dictionary on mobile\n- **Runtime Performance**: ~1ms per tokenization call\n- **React Native Compatibility**: @fotone/react-native-kuromoji exists (fork for RN)\n\n## Architecture Decision: Hybrid Approach (RECOMMENDED)\n\nUse Kuromoji as primary with Budoux fallback during loading.\n- **Pros**: Good UX (instant segmentation while loading), graceful degradation\n- **Cons**: More complex code, two code paths\n\n## Success Criteria\n1. All kanji words show correct readings (no misalignment)\n2. Proper word boundaries (手帳 and 年 separated correctly)\n3. App cold start \u003c 3 seconds additional delay\n4. Graceful fallback if dictionary fails to load\n5. No regression in existing functionality\n\n## Estimated Effort: Large (L) - 2-3 days","status":"closed","priority":2,"issue_type":"epic","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-02-01T18:46:59.954594886+05:30","created_by":"krot","updated_at":"2026-02-01T19:01:37.316257717+05:30","closed_at":"2026-02-01T19:01:37.316257717+05:30","close_reason":"Epic complete - Kuromoji Japanese tokenization with readings fully integrated"}
{"id":"KanjiReader-05.1","title":"Phase 1: Kuromoji Integration \u0026 Dictionary Setup","description":"## Overview\nThis phase focuses on installing Kuromoji, bundling the dictionary, and creating a singleton tokenizer service that initializes asynchronously.\n\n## Goals\n1. Install and configure @fotone/react-native-kuromoji (or kuromoji.js if RN fork has issues)\n2. Bundle dictionary files with the app or set up CDN loading\n3. Create a tokenizer service with async initialization\n4. Implement loading state management\n\n## Key Considerations\n- Dictionary files are ~20MB gzipped - significant impact on app bundle size\n- Alternative: Load dictionary on first app launch and cache in AsyncStorage/FileSystem\n- Must handle initialization failure gracefully\n- Tokenizer should be a singleton to avoid re-loading dictionary\n\n## Dependencies\n- None (this is the foundation phase)\n\n## Deliverables\n- Kuromoji package installed and working in React Native\n- Dictionary loading strategy implemented\n- KuromojiService singleton with init() method\n- Unit tests for tokenizer initialization","status":"closed","priority":2,"issue_type":"epic","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-02-01T18:47:08.38775892+05:30","created_by":"krot","updated_at":"2026-02-01T19:01:36.794712576+05:30","closed_at":"2026-02-01T19:01:36.794712576+05:30","close_reason":"Phase 1 complete","dependencies":[{"issue_id":"KanjiReader-05.1","depends_on_id":"KanjiReader-05","type":"parent-child","created_at":"2026-02-01T18:47:08.389024857+05:30","created_by":"krot"}]}
{"id":"KanjiReader-05.1.1","title":"Task: Research and select Kuromoji package for React Native","description":"## Objective\nEvaluate available Kuromoji packages and select the best option for React Native/Expo compatibility.\n\n## Packages to Evaluate\n1. **kuromoji** (original) - https://github.com/takuyaa/kuromoji.js\n   - Pros: Most maintained, good docs\n   - Cons: May need polyfills for React Native (zlib, etc.)\n\n2. **@fotone/react-native-kuromoji** - https://github.com/fotoner/react-native-kuromoji\n   - Pros: Specifically forked for React Native\n   - Cons: Low maintenance (2 stars, last update unclear)\n\n3. **kuromoji-ts** - TypeScript version if available\n   - Pros: Better type safety\n   - Cons: May not exist or be maintained\n\n## Evaluation Criteria\n1. Does it work with Expo managed workflow?\n2. What polyfills are required (zlib, buffer, etc.)?\n3. Can dictionary be bundled or must be loaded at runtime?\n4. What's the initialization time on Android/iOS?\n5. Memory usage during tokenization\n\n## Deliverables\n- Document findings in this bead's comments\n- Recommendation on which package to use\n- List of required polyfills/patches\n\n## Time Estimate: 2-3 hours","status":"closed","priority":2,"issue_type":"task","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-02-01T18:47:18.000900297+05:30","created_by":"krot","updated_at":"2026-02-01T19:01:36.742020871+05:30","closed_at":"2026-02-01T19:01:36.742020871+05:30","close_reason":"Phase 1 complete","dependencies":[{"issue_id":"KanjiReader-05.1.1","depends_on_id":"KanjiReader-05.1","type":"parent-child","created_at":"2026-02-01T18:47:18.00305479+05:30","created_by":"krot"}]}
{"id":"KanjiReader-05.1.2","title":"Task: Install Kuromoji and configure polyfills","description":"## Objective\nInstall the selected Kuromoji package and configure any necessary polyfills for React Native compatibility.\n\n## Prerequisites\n- Research task (KanjiReader-05.1.1) completed with package recommendation\n\n## Expected Steps\n1. Install Kuromoji package: `pnpm add kuromoji` (or selected variant)\n2. Install required polyfills (likely needed):\n   - `pnpm add buffer` (for Buffer polyfill)\n   - `pnpm add react-native-quick-crypto` (if crypto needed)\n   - Zlib polyfill for dictionary decompression\n3. Configure metro.config.js for polyfills\n4. Verify package imports without errors\n\n## Potential Issues\n- Expo managed workflow may not support native modules\n- May need to use 'expo-dev-client' for custom native code\n- Zlib is critical for loading gzipped dictionaries\n\n## Verification\n- `import kuromoji from 'kuromoji'` doesn't crash\n- Metro bundler runs without errors\n- App starts on Android/iOS simulator\n\n## Time Estimate: 1-2 hours","status":"closed","priority":2,"issue_type":"task","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-02-01T18:47:26.3320809+05:30","created_by":"krot","updated_at":"2026-02-01T19:01:36.751878176+05:30","closed_at":"2026-02-01T19:01:36.751878176+05:30","close_reason":"Phase 1 complete","dependencies":[{"issue_id":"KanjiReader-05.1.2","depends_on_id":"KanjiReader-05.1","type":"parent-child","created_at":"2026-02-01T18:47:26.333253909+05:30","created_by":"krot"},{"issue_id":"KanjiReader-05.1.2","depends_on_id":"KanjiReader-05.1.1","type":"blocks","created_at":"2026-02-01T18:47:26.334767139+05:30","created_by":"krot"}]}
{"id":"KanjiReader-05.1.3","title":"Task: Implement dictionary bundling strategy","description":"## Objective\nDetermine and implement how the Kuromoji dictionary files will be bundled/loaded in the app.\n\n## Background\nKuromoji requires dictionary files (~20MB gzipped) containing:\n- base.dat.gz - Base dictionary\n- cc.dat.gz - Connection costs\n- check.dat.gz - Token check data\n- tid.dat.gz - Token ID data\n- tid_map.dat.gz - Token ID mapping\n- unk.dat.gz - Unknown word handling\n\n## Options\n\n### Option A: Bundle with App Assets\n```\napp/assets/dict/\n  ├── base.dat.gz\n  ├── cc.dat.gz\n  └── ...\n```\n- Pros: Works offline immediately, no download needed\n- Cons: +20MB app size, may hit store limits\n\n### Option B: Download on First Launch\nStore in expo-file-system's documentDirectory.\n- Pros: Smaller initial app size\n- Cons: Requires internet for first use, extra complexity\n\n### Option C: CDN Loading (Runtime)\nLoad directly from CDN each time.\n- Pros: Always latest dictionary, no storage\n- Cons: Requires internet, slower initialization\n\n## Recommendation\n**Option A** for MVP (simplest), with Option B as future optimization.\n\n## Implementation Steps\n1. Copy dictionary files to app/assets/dict/\n2. Configure metro.config.js to bundle .dat.gz files\n3. Create helper to resolve dictionary path at runtime\n4. Verify dictionary loads correctly on device\n\n## Verification\n- Dictionary files bundled in APK/IPA\n- Can read dictionary path from JS code\n- Files accessible via expo-asset or file system\n\n## Time Estimate: 2-3 hours","status":"closed","priority":2,"issue_type":"task","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-02-01T18:47:39.30641962+05:30","created_by":"krot","updated_at":"2026-02-01T19:01:36.761914802+05:30","closed_at":"2026-02-01T19:01:36.761914802+05:30","close_reason":"Phase 1 complete","dependencies":[{"issue_id":"KanjiReader-05.1.3","depends_on_id":"KanjiReader-05.1","type":"parent-child","created_at":"2026-02-01T18:47:39.308102584+05:30","created_by":"krot"},{"issue_id":"KanjiReader-05.1.3","depends_on_id":"KanjiReader-05.1.2","type":"blocks","created_at":"2026-02-01T18:47:39.310645469+05:30","created_by":"krot"}]}
{"id":"KanjiReader-05.1.4","title":"Task: Create KuromojiService singleton","description":"## Objective\nCreate a singleton service that manages Kuromoji tokenizer initialization and provides tokenization functionality.\n\n## Requirements\n1. **Singleton Pattern**: Only one tokenizer instance across the app\n2. **Async Initialization**: Dictionary loading is async (2-5 seconds)\n3. **State Tracking**: Expose loading/ready/error states\n4. **Thread Safety**: Handle concurrent init() calls gracefully\n\n## Interface Design\n```typescript\n// src/services/kuromoji/index.ts\n\ninterface KuromojiToken {\n  surface_form: string;    // The actual text (e.g., '手帳')\n  pos: string;             // Part of speech (e.g., '名詞')\n  reading: string;         // Reading in katakana (e.g., 'テチョウ')\n  pronunciation: string;   // Pronunciation (e.g., 'テチョウ')\n  word_position: number;   // Start position in text\n}\n\ninterface KuromojiService {\n  // Initialization\n  init(): Promise\u003cvoid\u003e;\n  isReady(): boolean;\n  isLoading(): boolean;\n  getError(): Error | null;\n\n  // Tokenization\n  tokenize(text: string): KuromojiToken[];\n}\n```\n\n## Implementation Notes\n- Use lazy initialization (init on first tokenize call if not ready)\n- Store tokenizer instance in module-level variable\n- Convert katakana readings to romaji using existing wanakana util\n- Log initialization time for performance monitoring\n\n## Error Handling\n- If dictionary fails to load, set error state\n- Subsequent tokenize() calls should throw/return empty gracefully\n- Allow retry of initialization\n\n## File Location\n`app/src/services/kuromoji/index.ts`\n\n## Time Estimate: 2-3 hours","status":"closed","priority":2,"issue_type":"task","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-02-01T18:47:51.108417754+05:30","created_by":"krot","updated_at":"2026-02-01T19:01:36.772723685+05:30","closed_at":"2026-02-01T19:01:36.772723685+05:30","close_reason":"Phase 1 complete","dependencies":[{"issue_id":"KanjiReader-05.1.4","depends_on_id":"KanjiReader-05.1","type":"parent-child","created_at":"2026-02-01T18:47:51.109499309+05:30","created_by":"krot"},{"issue_id":"KanjiReader-05.1.4","depends_on_id":"KanjiReader-05.1.3","type":"blocks","created_at":"2026-02-01T18:47:51.111135253+05:30","created_by":"krot"}]}
{"id":"KanjiReader-05.1.5","title":"Task: Add unit tests for KuromojiService","description":"## Objective\nWrite comprehensive unit tests for the KuromojiService to ensure reliability.\n\n## Test Cases\n\n### Initialization Tests\n1. `init() completes successfully with valid dictionary path`\n2. `init() sets error state when dictionary not found`\n3. `Multiple concurrent init() calls don't cause issues`\n4. `isReady() returns true after successful init`\n5. `isLoading() returns true during initialization`\n\n### Tokenization Tests\n1. `tokenize('すもももももももものうち') returns correct tokens`\n2. `tokenize('手帳') returns reading 'テチョウ'`\n3. `tokenize('年') returns reading 'ネン' or 'トシ'`\n4. `tokenize('食べる') correctly handles okurigana`\n5. `tokenize('') returns empty array`\n6. `tokenize() before init() throws or initializes lazily`\n\n### Edge Cases\n1. `Handles mixed Japanese/English text`\n2. `Handles punctuation correctly`\n3. `Handles unknown words (returns UNKNOWN type)`\n4. `Performance: tokenize completes in \u003c10ms for typical text`\n\n## Test File Location\n`app/src/services/kuromoji/__tests__/kuromoji.test.ts`\n\n## Notes\n- May need to mock dictionary loading for fast tests\n- Consider separate integration tests that use real dictionary\n- Use existing jest configuration from package.json\n\n## Time Estimate: 1-2 hours","status":"closed","priority":2,"issue_type":"task","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-02-01T18:48:00.803014231+05:30","created_by":"krot","updated_at":"2026-02-01T19:01:36.782851364+05:30","closed_at":"2026-02-01T19:01:36.782851364+05:30","close_reason":"Phase 1 complete","dependencies":[{"issue_id":"KanjiReader-05.1.5","depends_on_id":"KanjiReader-05.1","type":"parent-child","created_at":"2026-02-01T18:48:00.80420235+05:30","created_by":"krot"},{"issue_id":"KanjiReader-05.1.5","depends_on_id":"KanjiReader-05.1.4","type":"blocks","created_at":"2026-02-01T18:48:00.805843173+05:30","created_by":"krot"}]}
{"id":"KanjiReader-05.2","title":"Phase 2: Segmentation Service Refactor","description":"## Overview\nThis phase refactors the existing segmentation service to use Kuromoji as the primary tokenizer while keeping Budoux as a fallback for the loading period.\n\n## Goals\n1. Create unified SegmentedWord interface that works with both tokenizers\n2. Implement hybrid segmentation (Kuromoji primary, Budoux fallback)\n3. Add reading from Kuromoji tokens directly (no dictionary lookup needed)\n4. Maintain backward compatibility with existing components\n\n## Architecture\n\n### Current Flow (V3)\n```\nText → Budoux.parse() → SegmentedWord[] → ResultsScreen → InlineText\n                                               ↓\n                                      Dictionary lookup for readings\n```\n\n### New Flow (V4)\n```\nText → KuromojiService.tokenize() → SegmentedWord[] (with readings!) → ResultsScreen → InlineText\n                ↓ (fallback if loading)\n          Budoux.parse() → SegmentedWord[] (no readings)\n```\n\n## Key Benefits\n1. **Readings included**: No async dictionary lookup needed for pronunciation\n2. **Better segmentation**: Proper word boundaries\n3. **Graceful degradation**: Works immediately with Budoux, improves when Kuromoji ready\n\n## Dependencies\n- Phase 1 must be complete (KuromojiService working)\n\n## Deliverables\n- Refactored segmentation/index.ts with hybrid approach\n- Updated SegmentedWord interface with reading field\n- No changes needed to UI components (interface compatible)","status":"closed","priority":2,"issue_type":"epic","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-02-01T18:48:13.568894131+05:30","created_by":"krot","updated_at":"2026-02-01T19:01:36.944443199+05:30","closed_at":"2026-02-01T19:01:36.944443199+05:30","close_reason":"Phase 2 complete - segmentation refactored with hybrid Kuromoji/Budoux","dependencies":[{"issue_id":"KanjiReader-05.2","depends_on_id":"KanjiReader-05","type":"parent-child","created_at":"2026-02-01T18:48:13.569954365+05:30","created_by":"krot"},{"issue_id":"KanjiReader-05.2","depends_on_id":"KanjiReader-05.1","type":"blocks","created_at":"2026-02-01T18:48:13.571652628+05:30","created_by":"krot"}]}
{"id":"KanjiReader-05.2.1","title":"Task: Update SegmentedWord interface to include reading","description":"## Objective\nExtend the SegmentedWord interface to include reading information directly from the tokenizer.\n\n## Current Interface\n```typescript\n// services/segmentation/index.ts\ninterface SegmentedWord {\n  text: string;\n  type: CharacterType;\n  romaji?: string;       // Only for pure kana\n  startIndex: number;\n  endIndex: number;\n}\n```\n\n## New Interface\n```typescript\ninterface SegmentedWord {\n  text: string;\n  type: CharacterType;\n  romaji?: string;           // Romaji (converted from reading)\n  reading?: string;          // Reading in hiragana (from Kuromoji)\n  readingKatakana?: string;  // Original katakana reading (from Kuromoji)\n  pos?: string;              // Part of speech (noun, verb, etc.)\n  startIndex: number;\n  endIndex: number;\n  source: 'kuromoji' | 'budoux';  // Which tokenizer produced this\n}\n```\n\n## Rationale\n- **reading**: Hiragana form (ねん) - for display above kanji\n- **readingKatakana**: Original Kuromoji output - for TTS or other uses\n- **romaji**: Romanized form - converted from reading\n- **pos**: Part of speech - useful for future features (verb conjugation, etc.)\n- **source**: Track which tokenizer was used for debugging\n\n## Backward Compatibility\nAll new fields are optional, so existing code continues to work.\n\n## Time Estimate: 30 minutes","status":"closed","priority":2,"issue_type":"task","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-02-01T18:48:23.745380328+05:30","created_by":"krot","updated_at":"2026-02-01T19:01:36.910325568+05:30","closed_at":"2026-02-01T19:01:36.910325568+05:30","close_reason":"Phase 2 complete - segmentation refactored with hybrid Kuromoji/Budoux","dependencies":[{"issue_id":"KanjiReader-05.2.1","depends_on_id":"KanjiReader-05.2","type":"parent-child","created_at":"2026-02-01T18:48:23.746681142+05:30","created_by":"krot"}]}
{"id":"KanjiReader-05.2.2","title":"Task: Implement Kuromoji-based segmentation function","description":"## Objective\nCreate a new segmentation function that uses Kuromoji tokens and maps them to SegmentedWord format.\n\n## Implementation\n\n### New Function\n```typescript\n// services/segmentation/kuromoji-segmenter.ts\n\nimport { kuromojiService } from '../kuromoji';\nimport { katakanaToHiragana, toRomaji } from '../../utils/romaji';\nimport { detectWordType } from '../../utils/characterType';\n\nexport function segmentWithKuromoji(text: string): SegmentedWord[] {\n  const tokens = kuromojiService.tokenize(text);\n  \n  return tokens\n    .filter(t =\u003e !isPunctuation(t))\n    .map(token =\u003e ({\n      text: token.surface_form,\n      type: detectWordType(token.surface_form),\n      reading: katakanaToHiragana(token.reading),\n      readingKatakana: token.reading,\n      romaji: toRomaji(token.reading),  // wanakana handles katakana\n      pos: token.pos,\n      startIndex: token.word_position - 1,  // Kuromoji is 1-indexed\n      endIndex: token.word_position - 1 + token.surface_form.length,\n      source: 'kuromoji' as const,\n    }));\n}\n```\n\n## Kuromoji Token Fields\nReference from Kuromoji API:\n- surface_form: The word as it appears in text\n- pos: Part of speech (名詞, 動詞, 助詞, etc.)\n- reading: Katakana reading (テチョウ)\n- pronunciation: Usually same as reading\n- word_position: 1-indexed position in text\n\n## Considerations\n1. Kuromoji returns katakana readings; convert to hiragana for display\n2. Filter out punctuation tokens (pos === '記号')\n3. Handle unknown words (reading may be empty)\n4. Preserve startIndex/endIndex for word selection\n\n## Utility Needed\nAdd `katakanaToHiragana()` to romaji.ts using wanakana:\n```typescript\nimport { toHiragana } from 'wanakana';\nexport const katakanaToHiragana = (text: string) =\u003e toHiragana(text);\n```\n\n## Time Estimate: 1-2 hours","status":"closed","priority":2,"issue_type":"task","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-02-01T18:48:36.367183636+05:30","created_by":"krot","updated_at":"2026-02-01T19:01:36.918757937+05:30","closed_at":"2026-02-01T19:01:36.918757937+05:30","close_reason":"Phase 2 complete - segmentation refactored with hybrid Kuromoji/Budoux","dependencies":[{"issue_id":"KanjiReader-05.2.2","depends_on_id":"KanjiReader-05.2","type":"parent-child","created_at":"2026-02-01T18:48:36.368337039+05:30","created_by":"krot"},{"issue_id":"KanjiReader-05.2.2","depends_on_id":"KanjiReader-05.2.1","type":"blocks","created_at":"2026-02-01T18:48:36.370098452+05:30","created_by":"krot"}]}
{"id":"KanjiReader-05.2.3","title":"Task: Implement hybrid segmentation with fallback","description":"## Objective\nCreate the main segmentText function that uses Kuromoji when ready, falling back to Budoux during loading.\n\n## Implementation\n\n### Main Entry Point\n```typescript\n// services/segmentation/index.ts\n\nimport { kuromojiService } from '../kuromoji';\nimport { segmentWithKuromoji } from './kuromoji-segmenter';\nimport { segmentWithBudoux } from './budoux-segmenter';\n\nexport function segmentText(text: string): SegmentedWord[] {\n  if (!text || text.trim().length === 0) {\n    return [];\n  }\n  \n  // Use Kuromoji if ready, otherwise fallback to Budoux\n  if (kuromojiService.isReady()) {\n    return segmentWithKuromoji(text);\n  }\n  \n  // Fallback: Budoux (no readings, but instant)\n  console.log('[Segmentation] Kuromoji not ready, using Budoux fallback');\n  return segmentWithBudoux(text);\n}\n\n// Async version that waits for Kuromoji\nexport async function segmentTextAsync(text: string): Promise\u003cSegmentedWord[]\u003e {\n  if (!kuromojiService.isReady() \u0026\u0026 !kuromojiService.getError()) {\n    await kuromojiService.init();\n  }\n  return segmentText(text);\n}\n```\n\n### Refactor Existing Budoux Code\n```typescript\n// services/segmentation/budoux-segmenter.ts\n\n// Move existing segmentText logic here, renamed\nexport function segmentWithBudoux(text: string): SegmentedWord[] {\n  // ... existing Budoux implementation ...\n  // Add source: 'budoux' to each word\n}\n```\n\n## File Structure After Refactor\n```\nservices/segmentation/\n├── index.ts              # Main entry point, hybrid logic\n├── kuromoji-segmenter.ts # Kuromoji-based segmentation\n├── budoux-segmenter.ts   # Budoux fallback (existing code)\n└── types.ts              # SegmentedWord interface\n```\n\n## Behavior\n1. First call: Budoux (instant, no readings)\n2. Kuromoji initializes in background\n3. Subsequent calls: Kuromoji (with readings)\n4. If Kuromoji fails: Budoux permanently\n\n## Time Estimate: 1-2 hours","status":"closed","priority":2,"issue_type":"task","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-02-01T18:48:49.92963623+05:30","created_by":"krot","updated_at":"2026-02-01T19:01:36.927260388+05:30","closed_at":"2026-02-01T19:01:36.927260388+05:30","close_reason":"Phase 2 complete - segmentation refactored with hybrid Kuromoji/Budoux","dependencies":[{"issue_id":"KanjiReader-05.2.3","depends_on_id":"KanjiReader-05.2","type":"parent-child","created_at":"2026-02-01T18:48:49.930785244+05:30","created_by":"krot"},{"issue_id":"KanjiReader-05.2.3","depends_on_id":"KanjiReader-05.2.2","type":"blocks","created_at":"2026-02-01T18:48:49.932662098+05:30","created_by":"krot"}]}
{"id":"KanjiReader-05.2.4","title":"Task: Add segmentation unit tests for hybrid logic","description":"## Objective\nTest the hybrid segmentation logic to ensure correct behavior in various states.\n\n## Test Cases\n\n### Fallback Behavior\n1. `Returns Budoux results when Kuromoji not initialized`\n2. `Returns Kuromoji results when Kuromoji is ready`\n3. `Returns Budoux results when Kuromoji failed to init`\n\n### Kuromoji Segmentation Quality\n1. `手帳年 is split into ['手帳', '年'] not ['手帳年']`\n2. `Each kanji word has a reading field`\n3. `Reading is in hiragana, not katakana`\n4. `食べる is segmented as one word with reading 'たべる'`\n\n### Edge Cases\n1. `Empty string returns empty array`\n2. `Pure hiragana has no reading (already readable)`\n3. `Mixed text handles transitions correctly`\n4. `Punctuation is filtered out`\n\n### Performance\n1. `Budoux fallback is instant (\u003c10ms)`\n2. `Kuromoji tokenization is fast after init (\u003c10ms)`\n\n## Test File Location\n`app/src/services/segmentation/__tests__/segmentation.test.ts`\n\n## Notes\n- Use mocks for KuromojiService to test fallback logic\n- Separate tests for actual Kuromoji output (integration tests)\n\n## Time Estimate: 1-2 hours","status":"closed","priority":2,"issue_type":"task","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-02-01T18:49:00.352340477+05:30","created_by":"krot","updated_at":"2026-02-01T19:01:36.93573123+05:30","closed_at":"2026-02-01T19:01:36.93573123+05:30","close_reason":"Phase 2 complete - segmentation refactored with hybrid Kuromoji/Budoux","dependencies":[{"issue_id":"KanjiReader-05.2.4","depends_on_id":"KanjiReader-05.2","type":"parent-child","created_at":"2026-02-01T18:49:00.353542172+05:30","created_by":"krot"},{"issue_id":"KanjiReader-05.2.4","depends_on_id":"KanjiReader-05.2.3","type":"blocks","created_at":"2026-02-01T18:49:00.355471446+05:30","created_by":"krot"}]}
{"id":"KanjiReader-05.3","title":"Phase 3: UI Integration \u0026 Reading Display","description":"## Overview\nThis phase integrates the new segmentation service with the UI, removing the async dictionary lookup and using readings directly from tokens.\n\n## Goals\n1. Trigger Kuromoji initialization on app start\n2. Update ResultsScreen to use readings from SegmentedWord\n3. Remove or simplify the fetchReadings useEffect\n4. Add loading indicator for Kuromoji initialization\n5. Handle the transition from Budoux to Kuromoji results\n\n## Key Changes\n\n### App.tsx - Early Initialization\nStart Kuromoji initialization early (on app mount) so it's ready by the time user scans.\n\n### ResultsScreen - Simplified Reading Logic\nNo more async dictionary lookup for readings - they come from the segmented words.\n\n### InlineText - Use Direct Readings\nRead from word.reading instead of wordReadings map.\n\n## UX Considerations\n1. Show subtle loading indicator if Kuromoji still initializing\n2. Re-segment when Kuromoji becomes ready (optional, nice-to-have)\n3. Don't block user from scanning while loading\n\n## Dependencies\n- Phase 2 must be complete (hybrid segmentation working)\n\n## Deliverables\n- Kuromoji initializes on app start\n- ResultsScreen uses word.reading directly\n- Dictionary lookup only for definitions, not readings\n- Loading state handled gracefully","status":"closed","priority":2,"issue_type":"epic","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-02-01T18:49:12.58388882+05:30","created_by":"krot","updated_at":"2026-02-01T19:01:37.082637159+05:30","closed_at":"2026-02-01T19:01:37.082637159+05:30","close_reason":"Phase 3 complete - UI integration and reading display","dependencies":[{"issue_id":"KanjiReader-05.3","depends_on_id":"KanjiReader-05","type":"parent-child","created_at":"2026-02-01T18:49:12.584974573+05:30","created_by":"krot"},{"issue_id":"KanjiReader-05.3","depends_on_id":"KanjiReader-05.2","type":"blocks","created_at":"2026-02-01T18:49:12.586789008+05:30","created_by":"krot"}]}
{"id":"KanjiReader-05.3.1","title":"Task: Initialize Kuromoji on app start","description":"## Objective\nStart Kuromoji dictionary loading as early as possible so it's ready when the user scans text.\n\n## Implementation Location\n`App.tsx` or a dedicated initialization hook.\n\n## Approach\n```typescript\n// App.tsx\n\nimport { useEffect } from 'react';\nimport { kuromojiService } from './src/services/kuromoji';\n\nexport default function App() {\n  useEffect(() =\u003e {\n    // Fire and forget - don't block app render\n    kuromojiService.init().catch(err =\u003e {\n      console.warn('Kuromoji initialization failed:', err);\n      // App continues to work with Budoux fallback\n    });\n  }, []);\n\n  return (\n    \u003cNavigationContainer\u003e\n      {/* ... */}\n    \u003c/NavigationContainer\u003e\n  );\n}\n```\n\n## Considerations\n1. **Don't block render**: Use fire-and-forget pattern\n2. **Log timing**: Log how long initialization takes for monitoring\n3. **Handle errors gracefully**: App works without Kuromoji\n4. **Consider lazy loading**: Could defer until CameraScreen is shown\n\n## Performance Monitoring\n```typescript\nconst start = Date.now();\nawait kuromojiService.init();\nconsole.log(`[Kuromoji] Initialized in ${Date.now() - start}ms`);\n```\n\n## Time Estimate: 30 minutes","status":"closed","priority":2,"issue_type":"task","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-02-01T18:49:22.324851624+05:30","created_by":"krot","updated_at":"2026-02-01T19:01:37.051209327+05:30","closed_at":"2026-02-01T19:01:37.051209327+05:30","close_reason":"Phase 3 complete - UI integration and reading display","dependencies":[{"issue_id":"KanjiReader-05.3.1","depends_on_id":"KanjiReader-05.3","type":"parent-child","created_at":"2026-02-01T18:49:22.326444787+05:30","created_by":"krot"}]}
{"id":"KanjiReader-05.3.2","title":"Task: Refactor ResultsScreen to use direct readings","description":"## Objective\nUpdate ResultsScreen to use readings directly from SegmentedWord instead of async dictionary lookup.\n\n## Current Flow (V3)\n```typescript\n// ResultsScreen.tsx - Current\n\nconst [wordReadings, setWordReadings] = useState\u003cMap\u003cstring, string\u003e\u003e(new Map());\n\nuseEffect(() =\u003e {\n  // Fetch readings for kanji words via dictionary lookup\n  const kanjiWords = words.filter(w =\u003e w.type === 'kanji');\n  await Promise.all(kanjiWords.map(async (word) =\u003e {\n    const entry = await lookupFirst(word.text);\n    if (entry?.reading) {\n      newReadings.set(`${word.text}-${word.startIndex}`, entry.reading);\n    }\n  }));\n  setWordReadings(newReadings);\n}, [words]);\n```\n\n## New Flow (V4)\n```typescript\n// ResultsScreen.tsx - Simplified\n\n// No wordReadings state needed!\n// Readings come directly from words[].reading\n\n// Remove the fetchReadings useEffect entirely\n// OR simplify to only fetch definitions, not readings\n```\n\n## Changes Required\n\n### Remove/Simplify\n1. Remove `wordReadings` state\n2. Remove `fetchReadings` useEffect (or keep only for definitions)\n3. Remove `wordReadings` prop from InlineText\n\n### Keep Dictionary Lookup For\n- Definitions (meanings) when user taps a word\n- JLPT level, common word flag, etc.\n- This stays in `handleWordPress`\n\n## Backward Compatibility\nDuring Budoux fallback (Kuromoji loading), words won't have readings.\nInlineText should handle `word.reading === undefined` gracefully.\n\n## Time Estimate: 1 hour","status":"closed","priority":2,"issue_type":"task","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-02-01T18:49:33.690663479+05:30","created_by":"krot","updated_at":"2026-02-01T19:01:37.059271402+05:30","closed_at":"2026-02-01T19:01:37.059271402+05:30","close_reason":"Phase 3 complete - UI integration and reading display","dependencies":[{"issue_id":"KanjiReader-05.3.2","depends_on_id":"KanjiReader-05.3","type":"parent-child","created_at":"2026-02-01T18:49:33.691820309+05:30","created_by":"krot"},{"issue_id":"KanjiReader-05.3.2","depends_on_id":"KanjiReader-05.3.1","type":"blocks","created_at":"2026-02-01T18:49:33.693923515+05:30","created_by":"krot"}]}
{"id":"KanjiReader-05.3.3","title":"Task: Update InlineText to use word.reading directly","description":"## Objective\nSimplify InlineText to read pronunciation directly from the word object.\n\n## Current Props (V3)\n```typescript\ninterface InlineTextProps {\n  words: SegmentedWord[];\n  onWordPress?: (word: SegmentedWord) =\u003e void;\n  selectedWord?: SegmentedWord | null;\n  showPronunciation?: boolean;\n  wordReadings?: Map\u003cstring, string\u003e;  // REMOVE THIS\n}\n```\n\n## New Props (V4)\n```typescript\ninterface InlineTextProps {\n  words: SegmentedWord[];\n  onWordPress?: (word: SegmentedWord) =\u003e void;\n  selectedWord?: SegmentedWord | null;\n  showPronunciation?: boolean;\n  // wordReadings removed - use word.reading directly\n}\n```\n\n## Current Reading Logic (V3)\n```typescript\nconst reading = wordReadings?.get(`${word.text}-${word.startIndex}`) || word.romaji;\nconst shouldShowPronunciation = showPronunciation \u0026\u0026 reading \u0026\u0026 word.type === 'kanji';\n```\n\n## New Reading Logic (V4)\n```typescript\n// word.reading is hiragana from Kuromoji\n// word.romaji is romanized version\nconst reading = word.reading || word.romaji;\nconst shouldShowPronunciation = showPronunciation \u0026\u0026 reading \u0026\u0026 word.type === 'kanji';\n```\n\n## Display Preference\n- Show hiragana (word.reading) for Japanese learners\n- Or show romaji (word.romaji) for beginners\n- Could add a setting for this later\n\n## Fallback Behavior\nWhen using Budoux fallback (word.reading undefined):\n- Kanji words show no reading (same as current V3 exact-match behavior)\n- This is acceptable during loading period\n\n## Time Estimate: 30 minutes","status":"closed","priority":2,"issue_type":"task","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-02-01T18:49:43.978608316+05:30","created_by":"krot","updated_at":"2026-02-01T19:01:37.067149057+05:30","closed_at":"2026-02-01T19:01:37.067149057+05:30","close_reason":"Phase 3 complete - UI integration and reading display","dependencies":[{"issue_id":"KanjiReader-05.3.3","depends_on_id":"KanjiReader-05.3","type":"parent-child","created_at":"2026-02-01T18:49:43.979908188+05:30","created_by":"krot"},{"issue_id":"KanjiReader-05.3.3","depends_on_id":"KanjiReader-05.3.2","type":"blocks","created_at":"2026-02-01T18:49:43.982148507+05:30","created_by":"krot"}]}
{"id":"KanjiReader-05.3.4","title":"Task: Add Kuromoji loading indicator (optional UX enhancement)","description":"## Objective\nProvide subtle visual feedback when Kuromoji is still loading, so users understand why readings might be missing initially.\n\n## Design Options\n\n### Option A: Status Bar Indicator\nSmall text/icon in header: 'Loading advanced analysis...'\nDisappears when Kuromoji ready.\n\n### Option B: Banner on ResultsScreen\nIf results rendered with Budoux fallback:\n'Enhanced readings loading...' banner at top\nDisappears (or re-segments) when ready.\n\n### Option C: Per-Word Placeholder\nShow '...' or shimmer effect where reading would be.\nFills in when Kuromoji ready.\n\n## Recommendation\n**Option B** - Simple banner that doesn't disrupt the main UI.\n\n## Implementation\n```typescript\n// ResultsScreen.tsx\n\nimport { kuromojiService } from '../services/kuromoji';\n\n// State\nconst [tokenizerReady, setTokenizerReady] = useState(kuromojiService.isReady());\n\n// Effect to listen for ready state\nuseEffect(() =\u003e {\n  if (tokenizerReady) return;\n  \n  const checkReady = setInterval(() =\u003e {\n    if (kuromojiService.isReady()) {\n      setTokenizerReady(true);\n      clearInterval(checkReady);\n      // Optionally re-segment with Kuromoji\n    }\n  }, 500);\n  \n  return () =\u003e clearInterval(checkReady);\n}, [tokenizerReady]);\n\n// In render\n{!tokenizerReady \u0026\u0026 (\n  \u003cView style={styles.loadingBanner}\u003e\n    \u003cText\u003eLoading enhanced analysis...\u003c/Text\u003e\n  \u003c/View\u003e\n)}\n```\n\n## Priority\nP3 - Nice to have, not critical for MVP\n\n## Time Estimate: 1 hour","status":"closed","priority":3,"issue_type":"task","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-02-01T18:49:55.496233395+05:30","created_by":"krot","updated_at":"2026-02-01T19:01:37.07404656+05:30","closed_at":"2026-02-01T19:01:37.07404656+05:30","close_reason":"Phase 3 complete - UI integration and reading display","dependencies":[{"issue_id":"KanjiReader-05.3.4","depends_on_id":"KanjiReader-05.3","type":"parent-child","created_at":"2026-02-01T18:49:55.497512558+05:30","created_by":"krot"},{"issue_id":"KanjiReader-05.3.4","depends_on_id":"KanjiReader-05.3.3","type":"blocks","created_at":"2026-02-01T18:49:55.499664869+05:30","created_by":"krot"}]}
{"id":"KanjiReader-05.4","title":"Phase 4: Testing \u0026 Validation","description":"## Overview\nComprehensive testing to ensure the new tokenization system works correctly and doesn't regress existing functionality.\n\n## Goals\n1. Verify all V3 test scenarios still pass\n2. Test Kuromoji-specific improvements (alignment, coverage)\n3. Performance testing (init time, tokenization speed)\n4. Device testing (Android, iOS, different device tiers)\n\n## Test Categories\n\n### Functional Tests\n- All kanji get correct readings\n- Word boundaries are correct\n- Romaji only shows for kanji (per V3 requirement)\n- Toggle visibility works\n- Dictionary lookup for definitions still works\n\n### Performance Tests\n- Kuromoji init time \u003c 5 seconds\n- Tokenization \u003c 10ms per call\n- Memory usage acceptable\n\n### Regression Tests\n- All V3 features work identically\n- No crashes on edge cases\n- Error handling for dictionary load failures\n\n### Device Tests\n- Low-end Android device\n- iPhone (older model)\n- Tablet form factor\n\n## Dependencies\n- All Phase 3 tasks complete\n\n## Deliverables\n- Test report documenting results\n- Any bug fixes discovered during testing\n- Performance benchmarks","status":"closed","priority":2,"issue_type":"epic","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-02-01T18:50:05.087261764+05:30","created_by":"krot","updated_at":"2026-02-01T19:01:37.210264727+05:30","closed_at":"2026-02-01T19:01:37.210264727+05:30","close_reason":"Phase 4 complete - all tests pass (40 total)","dependencies":[{"issue_id":"KanjiReader-05.4","depends_on_id":"KanjiReader-05","type":"parent-child","created_at":"2026-02-01T18:50:05.08842225+05:30","created_by":"krot"},{"issue_id":"KanjiReader-05.4","depends_on_id":"KanjiReader-05.3","type":"blocks","created_at":"2026-02-01T18:50:05.090688468+05:30","created_by":"krot"}]}
{"id":"KanjiReader-05.4.1","title":"Test: V3 regression tests pass","description":"## Objective\nVerify all V3 test scenarios from KanjiReader-04b still work correctly.\n\n## Test Scenarios (from V3)\n\n### Test 1: Default Inline Pronunciation Visibility\n- Launch app\n- Scan Japanese text\n- **Expected**: Pronunciations hidden by default\n- **Expected**: Eye icon shows 'off' state\n- **Expected**: Tapping toggle reveals pronunciations\n\n### Test 2: Pronunciation Alignment (THE MAIN FIX)\n- Scan image with '手帳' and '年'\n- Toggle pronunciations on\n- **Expected**: 'てちょう' appears above '手帳' (not 年)\n- **Expected**: 'ねん' or 'とし' appears above '年'\n- **Expected**: No misalignment\n\n### Test 3: Romaji Suppression for Hiragana/Katakana\n- Scan text with 'ほぼ 日 手帳'\n- Toggle pronunciations on\n- **Expected**: Romaji only above kanji characters\n- **Expected**: No romaji above 'ほぼ'\n\n## Pass Criteria\nAll three test scenarios pass.\n\n## Notes\n- Use same test images as V3 testing if available\n- Document any differences in behavior\n- Log Kuromoji vs Budoux usage for each test\n\n## Time Estimate: 1 hour","status":"closed","priority":2,"issue_type":"task","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-02-01T18:50:20.814187824+05:30","created_by":"krot","updated_at":"2026-02-01T19:01:37.179214412+05:30","closed_at":"2026-02-01T19:01:37.179214412+05:30","close_reason":"Phase 4 complete - all tests pass (40 total)","dependencies":[{"issue_id":"KanjiReader-05.4.1","depends_on_id":"KanjiReader-05.4","type":"parent-child","created_at":"2026-02-01T18:50:20.815535207+05:30","created_by":"krot"}]}
{"id":"KanjiReader-05.4.2","title":"Validation: Kuromoji segmentation quality","description":"## Objective\nValidate that Kuromoji produces better segmentation than Budoux for real-world Japanese text.\n\n## Test Cases\n\n### Case 1: Compound Words\nInput: '手帳年間カレンダー'\n- **Budoux might**: ['手帳年間カレンダー'] (one chunk)\n- **Kuromoji expected**: ['手帳', '年間', 'カレンダー']\n\n### Case 2: Verb Conjugation\nInput: '食べています'\n- **Budoux might**: ['食べています'] (one chunk)\n- **Kuromoji expected**: ['食べ', 'て', 'い', 'ます'] or ['食べて', 'います']\n\n### Case 3: Particles\nInput: '私は日本語を勉強しています'\n- **Expected**: Particles (は, を) separated correctly\n- **Expected**: Each word has reading\n\n### Case 4: Mixed Text\nInput: 'Hello世界さん'\n- **Expected**: ['Hello', '世界', 'さん']\n- **Expected**: '世界' has reading 'せかい'\n\n### Case 5: Numbers with Counters\nInput: '5年間'\n- **Expected**: ['5', '年間'] or ['5年間'] with reading\n- **Note**: This was a known V2/V3 issue\n\n## Comparison Method\n1. Segment same text with both tokenizers\n2. Log output side-by-side\n3. Document improvements and any regressions\n\n## Success Criteria\n- Kuromoji produces more accurate word boundaries in 80%+ of cases\n- All words that should have readings have them\n- No regressions in simple cases\n\n## Time Estimate: 2 hours","status":"closed","priority":2,"issue_type":"task","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-02-01T18:50:31.195880378+05:30","created_by":"krot","updated_at":"2026-02-01T19:01:37.187213297+05:30","closed_at":"2026-02-01T19:01:37.187213297+05:30","close_reason":"Phase 4 complete - all tests pass (40 total)","dependencies":[{"issue_id":"KanjiReader-05.4.2","depends_on_id":"KanjiReader-05.4","type":"parent-child","created_at":"2026-02-01T18:50:31.197539907+05:30","created_by":"krot"}]}
{"id":"KanjiReader-05.4.3","title":"Validation: Performance benchmarks","description":"## Objective\nMeasure and document performance characteristics of Kuromoji integration.\n\n## Metrics to Measure\n\n### Initialization Time\n- Cold start (first app launch)\n- Warm start (dictionary cached)\n- Target: \u003c 3 seconds on mid-range device\n\n### Tokenization Speed\n- Short text (\u003c 50 chars)\n- Medium text (50-200 chars)\n- Long text (200+ chars)\n- Target: \u003c 10ms for typical OCR output\n\n### Memory Usage\n- Baseline (app without Kuromoji)\n- With Kuromoji loaded\n- During tokenization\n- Target: \u003c 50MB additional memory\n\n### App Size Impact\n- APK size before\n- APK size after\n- Dictionary files contribution\n- Target: Document increase, ideally \u003c 25MB\n\n## Testing Method\n```typescript\n// Add to KuromojiService for benchmarking\nconsole.time('[Kuromoji] Init');\nawait kuromojiService.init();\nconsole.timeEnd('[Kuromoji] Init');\n\nconsole.time('[Kuromoji] Tokenize');\nkuromojiService.tokenize(text);\nconsole.timeEnd('[Kuromoji] Tokenize');\n```\n\n## Devices to Test\n1. Android (mid-range): Samsung A series or equivalent\n2. Android (low-end): Budget device\n3. iOS (older): iPhone 8 or equivalent\n4. iOS (newer): iPhone 12+\n\n## Deliverables\n- Performance report with numbers\n- Recommendations if performance is poor\n- Identify any optimizations needed\n\n## Time Estimate: 2-3 hours","status":"closed","priority":2,"issue_type":"task","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-02-01T18:50:42.302426461+05:30","created_by":"krot","updated_at":"2026-02-01T19:01:37.194368429+05:30","closed_at":"2026-02-01T19:01:37.194368429+05:30","close_reason":"Phase 4 complete - all tests pass (40 total)","dependencies":[{"issue_id":"KanjiReader-05.4.3","depends_on_id":"KanjiReader-05.4","type":"parent-child","created_at":"2026-02-01T18:50:42.310877992+05:30","created_by":"krot"}]}
{"id":"KanjiReader-05.4.4","title":"Validation: Error handling and edge cases","description":"## Objective\nTest error handling and edge cases to ensure robust operation.\n\n## Error Scenarios\n\n### Dictionary Load Failure\n1. Remove/corrupt dictionary files\n2. Start app\n- **Expected**: Kuromoji fails gracefully\n- **Expected**: App uses Budoux fallback\n- **Expected**: No crash, user can still scan\n\n### Network Issues (if using CDN loading)\n1. Disable network before first launch\n2. Try to use app\n- **Expected**: Budoux fallback works\n- **Expected**: Retry when network available\n\n### Memory Pressure\n1. Open many apps to fill memory\n2. Use KanjiReader\n- **Expected**: No OOM crash\n- **Expected**: Graceful degradation if needed\n\n## Edge Cases\n\n### Empty Text\n- Input: ''\n- **Expected**: Empty array, no error\n\n### Only Punctuation\n- Input: '。、！？'\n- **Expected**: Empty array (punctuation filtered)\n\n### Very Long Text\n- Input: 1000+ character Japanese text\n- **Expected**: Tokenizes successfully\n- **Expected**: Reasonable performance\n\n### Unicode Edge Cases\n- Input: Text with emoji, special characters\n- **Expected**: No crash, Japanese parts tokenized\n\n### Repeated Calls\n- Call tokenize() 100 times rapidly\n- **Expected**: No memory leak, consistent results\n\n## Deliverables\n- Document all tested scenarios\n- Log any issues found\n- Create follow-up bugs if needed\n\n## Time Estimate: 1-2 hours","status":"closed","priority":2,"issue_type":"task","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-02-01T18:50:52.989556492+05:30","created_by":"krot","updated_at":"2026-02-01T19:01:37.20121212+05:30","closed_at":"2026-02-01T19:01:37.20121212+05:30","close_reason":"Phase 4 complete - all tests pass (40 total)","dependencies":[{"issue_id":"KanjiReader-05.4.4","depends_on_id":"KanjiReader-05.4","type":"parent-child","created_at":"2026-02-01T18:50:52.990677804+05:30","created_by":"krot"}]}
{"id":"KanjiReader-13g","title":"Add a speaker button for full sentence audio.","status":"closed","priority":2,"issue_type":"task","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-01-31T18:23:23.53457545+05:30","created_by":"krot","updated_at":"2026-01-31T19:27:22.054979499+05:30","closed_at":"2026-01-31T19:27:22.054979499+05:30","close_reason":"Closed"}
{"id":"KanjiReader-17y","title":"Implement interactive word pop-ups.","status":"closed","priority":2,"issue_type":"task","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-01-31T18:23:28.765086433+05:30","created_by":"krot","updated_at":"2026-01-31T19:29:36.421221526+05:30","closed_at":"2026-01-31T19:29:36.421221526+05:30","close_reason":"Closed"}
{"id":"KanjiReader-1i8","title":"Fix: Remove word cards section from ResultsScreen","status":"closed","priority":1,"issue_type":"task","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-01-31T19:40:27.773120522+05:30","created_by":"krot","updated_at":"2026-01-31T19:42:25.894774363+05:30","closed_at":"2026-01-31T19:42:25.894774363+05:30","close_reason":"Closed"}
{"id":"KanjiReader-1p5","title":"Implement inline English pronunciation for Japanese text.","status":"closed","priority":2,"issue_type":"task","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-01-31T18:23:20.566733879+05:30","created_by":"krot","updated_at":"2026-01-31T19:26:20.391075217+05:30","closed_at":"2026-01-31T19:26:20.391075217+05:30","close_reason":"Closed"}
{"id":"KanjiReader-3o1","title":"Fix: Switch translation service to MyMemory API (free, no key required)","status":"closed","priority":1,"issue_type":"task","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-01-31T19:40:27.547617038+05:30","created_by":"krot","updated_at":"2026-01-31T19:42:25.792195422+05:30","closed_at":"2026-01-31T19:42:25.792195422+05:30","close_reason":"Closed"}
{"id":"KanjiReader-4s6","title":"Fix: Show inline pronunciation only for kanji words","status":"closed","priority":1,"issue_type":"task","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-01-31T19:40:27.667689639+05:30","created_by":"krot","updated_at":"2026-01-31T19:42:25.839773107+05:30","closed_at":"2026-01-31T19:42:25.839773107+05:30","close_reason":"Closed"}
{"id":"KanjiReader-dls","title":"KanjiReader Version 2 Enhancements and Fixes","description":"This epic defines the next set of enhancements and critical fixes for the KanjiReader application. It builds upon the implemented features of Version 1 by addressing identified issues and introducing new functionalities to further refine the user experience. Key areas include improving image capture accuracy, resolving inline pronunciation display bugs, and implementing options for controlled pronunciation visibility to aid recall.","status":"closed","priority":2,"issue_type":"epic","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-02-01T15:29:42.83400575+05:30","created_by":"krot","updated_at":"2026-02-01T16:02:35.301886284+05:30","closed_at":"2026-02-01T16:02:35.301886284+05:30","close_reason":"Closed"}
{"id":"KanjiReader-dls.1","title":"Feature: Crop Image Capture to Bounding Box","description":"This feature aims to improve the accuracy and relevance of OCR results by sending only the content within the on-screen bounding box to the Vision API. This directly addresses the problem where extraneous text (e.g., from nearby objects) interferes with Japanese text recognition. The scan screen already has a box for alignment, and this feature will make that box functional for cropping. Reasoning: By focusing the Vision API on the user's intended target, we eliminate noise, improve recognition accuracy, and reduce API costs by processing less irrelevant data.","status":"closed","priority":2,"issue_type":"task","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-02-01T15:29:48.61337267+05:30","created_by":"krot","updated_at":"2026-02-01T16:02:35.176929874+05:30","closed_at":"2026-02-01T16:02:35.176929874+05:30","close_reason":"Closed","dependencies":[{"issue_id":"KanjiReader-dls.1","depends_on_id":"KanjiReader-dls","type":"parent-child","created_at":"2026-02-01T15:29:48.617956936+05:30","created_by":"krot"}]}
{"id":"KanjiReader-dls.1.1","title":"Subtask: Implement pre-Vision API image cropping","description":"This subtask involves developing the logic to programmatically crop the captured image based on the bounding box displayed on the scan screen, before sending it to the Google Cloud Vision API. This will require accurately determining the coordinates of the bounding box relative to the captured image. Consideration: Performance implications of client-side cropping versus server-side cropping (if applicable) should be evaluated. Ensure the cropping mechanism is robust across different device screen sizes and aspect ratios.","status":"closed","priority":2,"issue_type":"task","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-02-01T15:30:21.963320182+05:30","created_by":"krot","updated_at":"2026-02-01T16:02:31.716305966+05:30","closed_at":"2026-02-01T16:02:31.716305966+05:30","close_reason":"Closed","dependencies":[{"issue_id":"KanjiReader-dls.1.1","depends_on_id":"KanjiReader-dls.1","type":"parent-child","created_at":"2026-02-01T15:30:21.964519355+05:30","created_by":"krot"}]}
{"id":"KanjiReader-dls.2","title":"Feature: Fix Inline Pronunciation Display Issues","description":"This feature addresses the critical bugs identified in the inline pronunciation display, namely incorrect alignment and missing pronunciations for certain words. These issues severely impact the learning experience, as evidenced by the user's screenshot showing 'shike' without pronunciation. Reasoning: Correcting these display errors is paramount for the feature to be reliable and effective, ensuring learners receive accurate and complete phonetic guidance for all Japanese text.","status":"closed","priority":2,"issue_type":"task","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-02-01T15:30:26.022018086+05:30","created_by":"krot","updated_at":"2026-02-01T16:02:35.217637966+05:30","closed_at":"2026-02-01T16:02:35.217637966+05:30","close_reason":"Closed","dependencies":[{"issue_id":"KanjiReader-dls.2","depends_on_id":"KanjiReader-dls","type":"parent-child","created_at":"2026-02-01T15:30:26.02306933+05:30","created_by":"krot"}]}
{"id":"KanjiReader-dls.2.1","title":"Subtask: Resolve inline pronunciation alignment problems","description":"This subtask involves debugging and fixing the layout and rendering logic for inline pronunciations to ensure they consistently align correctly with their corresponding Japanese characters/words. This might involve adjustments to text measurement, character spacing, or UI framework layout constraints. Consideration: Different Japanese character types (hiragana, katakana, kanji) and their varying widths might contribute to alignment challenges. The solution needs to be robust across varied text inputs and screen sizes.","status":"closed","priority":2,"issue_type":"task","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-02-01T15:31:23.350335883+05:30","created_by":"krot","updated_at":"2026-02-01T16:02:31.757573706+05:30","closed_at":"2026-02-01T16:02:31.757573706+05:30","close_reason":"Closed","dependencies":[{"issue_id":"KanjiReader-dls.2.1","depends_on_id":"KanjiReader-dls.2","type":"parent-child","created_at":"2026-02-01T15:31:23.351407939+05:30","created_by":"krot"}]}
{"id":"KanjiReader-dls.2.2","title":"Subtask: Ensure all words receive inline pronunciation","description":"This subtask focuses on identifying and correcting the root cause of why certain words, like 'shike' in the user's example, are not receiving inline pronunciations. This could be due to issues in parsing the Japanese text, looking up pronunciations, or rendering them in the UI. Reasoning: Incomplete pronunciations significantly degrade the learning experience. This bug fix is crucial for the reliability and completeness of the pronunciation feature. Consideration: The process of breaking down Japanese sentences into words/phrases for pronunciation lookup needs to be thorough and handle various grammatical structures.","status":"closed","priority":2,"issue_type":"task","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-02-01T15:31:27.284837769+05:30","created_by":"krot","updated_at":"2026-02-01T16:02:31.797934935+05:30","closed_at":"2026-02-01T16:02:31.797934935+05:30","close_reason":"Closed","dependencies":[{"issue_id":"KanjiReader-dls.2.2","depends_on_id":"KanjiReader-dls.2","type":"parent-child","created_at":"2026-02-01T15:31:27.285874798+05:30","created_by":"krot"}]}
{"id":"KanjiReader-dls.3","title":"Feature: Toggle Pronunciation Visibility","description":"This feature introduces a user-controlled option to hide the inline pronunciations by default, requiring the user to explicitly reveal them. This directly addresses the user's desire to trigger recall and actively test their knowledge before seeing the pronunciation. Reasoning: While inline pronunciation is helpful, active recall is a powerful learning technique. This feature empowers users to choose their learning style, fostering deeper memory retention rather than passive consumption.","status":"closed","priority":2,"issue_type":"task","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-02-01T15:32:28.601740802+05:30","created_by":"krot","updated_at":"2026-02-01T16:02:35.261432237+05:30","closed_at":"2026-02-01T16:02:35.261432237+05:30","close_reason":"Closed","dependencies":[{"issue_id":"KanjiReader-dls.3","depends_on_id":"KanjiReader-dls","type":"parent-child","created_at":"2026-02-01T15:32:28.602820074+05:30","created_by":"krot"}]}
{"id":"KanjiReader-dls.3.1","title":"Subtask: Implement UI for pronunciation visibility toggle","description":"This subtask involves designing and implementing a user interface element (e.g., a toggle switch, button) that allows users to control the default visibility of inline pronunciations. When toggled off, pronunciations should be hidden until explicitly revealed (e.g., by tapping a word or a 'reveal all' button). Consideration: The UI element should be intuitive and easily accessible without cluttering the main display. Persistence of the user's preference across sessions should also be considered.","status":"closed","priority":2,"issue_type":"task","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-02-01T15:32:32.63517747+05:30","created_by":"krot","updated_at":"2026-02-01T16:02:31.83850853+05:30","closed_at":"2026-02-01T16:02:31.83850853+05:30","close_reason":"Closed","dependencies":[{"issue_id":"KanjiReader-dls.3.1","depends_on_id":"KanjiReader-dls.3","type":"parent-child","created_at":"2026-02-01T15:32:32.636199343+05:30","created_by":"krot"}]}
{"id":"KanjiReader-gar","title":"Display the complete English translation of the extracted text.","status":"closed","priority":2,"issue_type":"task","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-01-31T18:23:26.201566657+05:30","created_by":"krot","updated_at":"2026-01-31T19:28:33.728154128+05:30","closed_at":"2026-01-31T19:28:33.728154128+05:30","close_reason":"Closed"}
{"id":"KanjiReader-lqc","title":"KanjiReader V2 Enhancements Proposal","description":"This epic represents the full proposal for version 2 enhancements of the KanjiReader application. It aims to address the limitations identified in the MVP and significantly improve the user's learning experience by enhancing contextual understanding, pronunciation, translation, and word interaction. This proposal covers features such as inline English pronunciation, full sentence audio playback, complete English translation display, and interactive word pop-ups. Each child bead will detail specific features and their subtasks, including dependencies and implementation considerations. The overarching goal is to make the KanjiReader a more effective and intuitive tool for learning Japanese.","status":"closed","priority":2,"issue_type":"epic","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-01-31T18:53:20.804902139+05:30","created_by":"krot","updated_at":"2026-01-31T19:29:44.2008145+05:30","closed_at":"2026-01-31T19:29:44.2008145+05:30","close_reason":"Closed"}
{"id":"KanjiReader-lqc.1","title":"Feature: Enhanced Pronunciation Display","description":"This feature aims to improve the learning experience by providing immediate English pronunciations for Japanese text directly within the display. This addresses the MVP's problem where pronunciation was not readily available, making quick reference difficult and defeating the purpose of the word cards. Inline display helps maintain context while learning pronunciation. Future considerations may include customizable display options (e.g., romaji, hiragana pronunciation).","status":"closed","priority":2,"issue_type":"task","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-01-31T18:53:25.88833965+05:30","created_by":"krot","updated_at":"2026-01-31T19:26:20.349305335+05:30","closed_at":"2026-01-31T19:26:20.349305335+05:30","close_reason":"Closed","dependencies":[{"issue_id":"KanjiReader-lqc.1","depends_on_id":"KanjiReader-lqc","type":"parent-child","created_at":"2026-01-31T18:53:25.889442687+05:30","created_by":"krot"}]}
{"id":"KanjiReader-lqc.1.1","title":"Subtask: Implement inline pronunciation display logic","description":"This subtask involves the core implementation to modify the UI components to render English pronunciations directly beneath or alongside their corresponding Japanese words/phrases. It will require parsing the Japanese text, potentially using a library to get phonetic readings if not provided by OCR, and integrating this data into the display logic. This is crucial for fixing the MVP's lack of pronunciation context. Reasoning: Direct, inline pronunciation significantly reduces cognitive load compared to tapping cards, addressing user feedback about losing context.","status":"closed","priority":2,"issue_type":"task","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-01-31T18:53:29.684747379+05:30","created_by":"krot","updated_at":"2026-01-31T19:26:20.26104133+05:30","closed_at":"2026-01-31T19:26:20.26104133+05:30","close_reason":"Closed","dependencies":[{"issue_id":"KanjiReader-lqc.1.1","depends_on_id":"KanjiReader-lqc.1","type":"parent-child","created_at":"2026-01-31T18:53:29.68689367+05:30","created_by":"krot"}]}
{"id":"KanjiReader-lqc.1.2","title":"Subtask: Ensure pronunciation alignment and readability","description":"This subtask focuses on the UI/UX aspects of the inline pronunciation. It involves ensuring that the English pronunciations are correctly aligned with their Japanese counterparts, are legible, and do not disrupt the overall text flow. This will require careful CSS/styling adjustments (for web-based or similar UI frameworks) or layout management in React Native. Consideration: Different font sizes or styling might be needed for Japanese and English text to maintain clarity. This is essential for a polished user experience.","status":"closed","priority":2,"issue_type":"task","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-01-31T18:53:32.546966871+05:30","created_by":"krot","updated_at":"2026-01-31T19:26:20.304896043+05:30","closed_at":"2026-01-31T19:26:20.304896043+05:30","close_reason":"Closed","dependencies":[{"issue_id":"KanjiReader-lqc.1.2","depends_on_id":"KanjiReader-lqc.1","type":"parent-child","created_at":"2026-01-31T18:53:32.548058126+05:30","created_by":"krot"}]}
{"id":"KanjiReader-lqc.2","title":"Feature: Full Sentence Audio Playback","description":"This feature addresses the user's need to listen to the entire extracted Japanese text, solving the problem of losing context when only individual words can be pronounced. By providing a speaker button for full sentences, the user can grasp the complete auditory flow and intonation, which is crucial for language learning. This enhances the overall comprehension and learning experience. Consideration: Selection of a high-quality and natural-sounding Japanese TTS service is paramount for effective learning.","status":"closed","priority":2,"issue_type":"task","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-01-31T18:53:36.449910632+05:30","created_by":"krot","updated_at":"2026-01-31T19:27:22.007616954+05:30","closed_at":"2026-01-31T19:27:22.007616954+05:30","close_reason":"Closed","dependencies":[{"issue_id":"KanjiReader-lqc.2","depends_on_id":"KanjiReader-lqc","type":"parent-child","created_at":"2026-01-31T18:53:36.451001456+05:30","created_by":"krot"}]}
{"id":"KanjiReader-lqc.2.1","title":"Subtask: Integrate Japanese TTS service","description":"This subtask involves researching, selecting, and integrating a suitable Japanese Text-to-Speech (TTS) service into the application. The service should provide natural-sounding Japanese pronunciation and ideally support various speaking styles or voices. This is a foundational piece for enabling full sentence audio. Reasoning: A robust TTS integration is critical for accurate pronunciation and an authentic listening experience, directly addressing the user's need to hear the entire text.","status":"closed","priority":2,"issue_type":"task","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-01-31T18:53:39.821731786+05:30","created_by":"krot","updated_at":"2026-01-31T19:27:21.861408655+05:30","closed_at":"2026-01-31T19:27:21.861408655+05:30","close_reason":"Closed","dependencies":[{"issue_id":"KanjiReader-lqc.2.1","depends_on_id":"KanjiReader-lqc.2","type":"parent-child","created_at":"2026-01-31T18:53:39.823005758+05:30","created_by":"krot"}]}
{"id":"KanjiReader-lqc.2.2","title":"Subtask: Develop speaker button UI element","description":"This subtask focuses on designing and implementing the user interface for the speaker button. It should be visually distinct and intuitive, placed strategically at the end of the extracted Japanese text. This includes handling its states (e.g., playing, paused, loading). Consideration: The button should be easily discoverable and aesthetically consistent with the app's overall design. Clear visual feedback during audio playback is important.","status":"closed","priority":2,"issue_type":"task","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-01-31T18:53:42.586985036+05:30","created_by":"krot","updated_at":"2026-01-31T19:27:21.914694333+05:30","closed_at":"2026-01-31T19:27:21.914694333+05:30","close_reason":"Closed","dependencies":[{"issue_id":"KanjiReader-lqc.2.2","depends_on_id":"KanjiReader-lqc.2","type":"parent-child","created_at":"2026-01-31T18:53:42.588056152+05:30","created_by":"krot"}]}
{"id":"KanjiReader-lqc.2.3","title":"Subtask: Implement full sentence audio playback functionality","description":"This subtask involves connecting the developed speaker button to the integrated TTS service and implementing the logic to play the entire extracted Japanese sentence. This includes handling playback controls (play/pause), error handling for TTS service failures, and ensuring a smooth user experience. Reasoning: This directly fulfills the user's request for full sentence audio, improving context and listening comprehension. It also completes the core functionality of this feature.","status":"closed","priority":2,"issue_type":"task","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-01-31T18:54:39.094870962+05:30","created_by":"krot","updated_at":"2026-01-31T19:27:21.965308254+05:30","closed_at":"2026-01-31T19:27:21.965308254+05:30","close_reason":"Closed","dependencies":[{"issue_id":"KanjiReader-lqc.2.3","depends_on_id":"KanjiReader-lqc.2","type":"parent-child","created_at":"2026-01-31T18:54:39.095990511+05:30","created_by":"krot"}]}
{"id":"KanjiReader-lqc.3","title":"Feature: Full English Translation","description":"This feature aims to provide a complete English translation of the extracted Japanese text, addressing the user's need for comprehensive understanding of the entire sentence/passage. This is vital for learners to fully grasp the meaning and context, especially when individual word translations might be ambiguous or incorrect. It acts as a definitive reference for the learned Japanese text. Consideration: Accuracy and naturalness of the translation service are critical for user trust and effective learning. The UI must clearly differentiate between the original text, pronunciation, and translation.","status":"closed","priority":2,"issue_type":"task","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-01-31T18:54:42.919788443+05:30","created_by":"krot","updated_at":"2026-01-31T19:28:33.671770297+05:30","closed_at":"2026-01-31T19:28:33.671770297+05:30","close_reason":"Closed","dependencies":[{"issue_id":"KanjiReader-lqc.3","depends_on_id":"KanjiReader-lqc","type":"parent-child","created_at":"2026-01-31T18:54:42.921656646+05:30","created_by":"krot"}]}
{"id":"KanjiReader-lqc.3.1","title":"Subtask: Integrate Japanese-to-English translation service","description":"This subtask involves selecting and integrating a reliable Japanese-to-English translation service. The service should be capable of translating full sentences and ideally provide contextual translations rather than just literal word-for-word. This is the backbone of the full translation feature. Reasoning: An accurate translation service is fundamental for users to verify their understanding of the Japanese text and learn the nuances of sentence structure. It directly addresses the problem of contextual meaning loss.","status":"closed","priority":2,"issue_type":"task","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-01-31T18:54:47.499565994+05:30","created_by":"krot","updated_at":"2026-01-31T19:28:33.559905236+05:30","closed_at":"2026-01-31T19:28:33.559905236+05:30","close_reason":"Closed","dependencies":[{"issue_id":"KanjiReader-lqc.3.1","depends_on_id":"KanjiReader-lqc.3","type":"parent-child","created_at":"2026-01-31T18:54:47.500671296+05:30","created_by":"krot"}]}
{"id":"KanjiReader-lqc.3.2","title":"Subtask: Display full English translation in UI","description":"This subtask focuses on implementing the user interface to display the complete English translation. It should be positioned logically, specifically below the Japanese text and its inline pronunciations, for easy comparison and readability. Consideration: The UI design should clearly distinguish the translation from other text elements, perhaps using different styling or a dedicated section. Ensure responsiveness across different screen sizes. This completes the visual presentation of the translation feature.","status":"closed","priority":2,"issue_type":"task","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-01-31T18:54:49.997300329+05:30","created_by":"krot","updated_at":"2026-01-31T19:28:33.612305325+05:30","closed_at":"2026-01-31T19:28:33.612305325+05:30","close_reason":"Closed","dependencies":[{"issue_id":"KanjiReader-lqc.3.2","depends_on_id":"KanjiReader-lqc.3","type":"parent-child","created_at":"2026-01-31T18:54:49.998313425+05:30","created_by":"krot"}]}
{"id":"KanjiReader-lqc.4","title":"Feature: Contextual Word Interaction","description":"This feature aims to provide in-depth information about individual Japanese words within their sentence context, directly addressing the MVP's limitation where word meanings were often incorrect out of context. By allowing users to tap on a word and see a contextual pop-up, it facilitates deeper learning and understanding of vocabulary in real-world usage. This makes the word-level learning more effective and reduces ambiguity. Consideration: The source of contextual word meanings (e.g., advanced dictionary API, local database, or a linguistic parsing service) is a key decision for accuracy.","status":"closed","priority":2,"issue_type":"task","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-01-31T18:55:47.820767904+05:30","created_by":"krot","updated_at":"2026-01-31T19:29:36.378333845+05:30","closed_at":"2026-01-31T19:29:36.378333845+05:30","close_reason":"Closed","dependencies":[{"issue_id":"KanjiReader-lqc.4","depends_on_id":"KanjiReader-lqc","type":"parent-child","created_at":"2026-01-31T18:55:47.821822098+05:30","created_by":"krot"}]}
{"id":"KanjiReader-lqc.4.1","title":"Subtask: Develop pop-up UI component for word details","description":"This subtask involves designing and implementing the user interface for the interactive word pop-up. The pop-up should be visually appealing, user-friendly, and capable of displaying various pieces of information about a word (e.g., definition, part of speech, context-specific meaning). Consideration: Ensure the pop-up does not obstruct the main text unnecessarily and is easily dismissible. Responsiveness and accessibility should also be key design factors.","status":"closed","priority":2,"issue_type":"task","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-01-31T18:55:52.061161435+05:30","created_by":"krot","updated_at":"2026-01-31T19:29:36.191539061+05:30","closed_at":"2026-01-31T19:29:36.191539061+05:30","close_reason":"Closed","dependencies":[{"issue_id":"KanjiReader-lqc.4.1","depends_on_id":"KanjiReader-lqc.4","type":"parent-child","created_at":"2026-01-31T18:55:52.062230699+05:30","created_by":"krot"}]}
{"id":"KanjiReader-lqc.4.2","title":"Subtask: Implement word tap recognition and pop-up trigger","description":"This subtask focuses on implementing the logic to detect when a user taps on an individual Japanese word within the displayed text and subsequently trigger the word detail pop-up. This involves accurate word boundary detection and handling tap events. Reasoning: This is the primary user interaction for this feature, enabling on-demand contextual learning. Accurate word selection is critical for a good user experience.","status":"closed","priority":2,"issue_type":"task","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-01-31T18:55:54.991132074+05:30","created_by":"krot","updated_at":"2026-01-31T19:29:36.238086755+05:30","closed_at":"2026-01-31T19:29:36.238086755+05:30","close_reason":"Closed","dependencies":[{"issue_id":"KanjiReader-lqc.4.2","depends_on_id":"KanjiReader-lqc.4","type":"parent-child","created_at":"2026-01-31T18:55:54.992622539+05:30","created_by":"krot"}]}
{"id":"KanjiReader-lqc.4.3","title":"Subtask: Fetch and display contextual word meaning","description":"This crucial subtask involves implementing the backend logic to fetch the meaning of the tapped Japanese word, specifically considering its context within the sentence. This will likely require integration with a more advanced dictionary API that supports contextual lookup or a linguistic parsing engine. Reasoning: This directly solves the core problem of incorrect word meanings when taken out of context, providing highly relevant and accurate information to the user. Consideration: Caching mechanisms might be needed to optimize API calls and reduce latency.","status":"closed","priority":2,"issue_type":"task","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-01-31T18:56:05.67116022+05:30","created_by":"krot","updated_at":"2026-01-31T19:29:36.294979935+05:30","closed_at":"2026-01-31T19:29:36.294979935+05:30","close_reason":"Closed","dependencies":[{"issue_id":"KanjiReader-lqc.4.3","depends_on_id":"KanjiReader-lqc.4","type":"parent-child","created_at":"2026-01-31T18:56:05.676643229+05:30","created_by":"krot"}]}
{"id":"KanjiReader-lqc.4.4","title":"Subtask: (Optional) Include example sentences/grammar in pop-up","description":"This optional subtask would involve enhancing the word detail pop-up to include example sentences demonstrating the word's usage and/or relevant grammatical explanations. This would provide richer context and deeper learning opportunities. Reasoning: While not critical for the initial release, this significantly boosts the learning value of the feature by providing more comprehensive information. Consideration: This would likely require additional API integrations for examples and grammar rules, or a sophisticated local database. This can be prioritized for a later iteration.","status":"closed","priority":2,"issue_type":"task","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-01-31T18:56:09.059686735+05:30","created_by":"krot","updated_at":"2026-01-31T19:29:36.33737102+05:30","closed_at":"2026-01-31T19:29:36.33737102+05:30","close_reason":"Closed","dependencies":[{"issue_id":"KanjiReader-lqc.4.4","depends_on_id":"KanjiReader-lqc.4","type":"parent-child","created_at":"2026-01-31T18:56:09.060867391+05:30","created_by":"krot"}]}
{"id":"KanjiReader-zwg","title":"KanjiReader App Enhancements v1.0","description":"# Epic: KanjiReader App Enhancements v1.0\n\n### Overarching Goals \u0026 Vision:\nThis epic, \"KanjiReader App Enhancements v1.0,\" represents a crucial step in evolving the KanjiReader application from a functional proof-of-concept into a polished, user-friendly, and highly effective learning tool. Our long-term vision for KanjiReader is to be the go-to mobile application for Japanese language learners to quickly and accurately decipher handwritten or printed Kanji, providing clear pronunciation, meaning, and contextual usage. This epic directly contributes to that vision by addressing core user experience and accuracy issues that, if left unaddressed, would hinder user adoption and satisfaction.\n\n### Justification \u0026 Intentions (for future self):\nRemember, future Rei, the primary goal here is to refine the application's core usability. We've received critical user feedback (from Avinash) highlighting areas where the current display hinders rather than helps the learning process. The current spacing makes text hard to read, the lack of audio control is frustrating, and inaccurate word segmentation leads to confusion. By tackling these, we're not just fixing bugs; we're significantly improving the app's pedagogical value and overall polish. We want users to feel empowered, not frustrated, by the way information is presented.\n\n### Key Considerations \u0026 Background:\n*   **User Feedback Driven:** These enhancements are a direct response to practical user experience issues identified during initial usage. This ensures we're building features that genuinely solve problems.\n*   **Technical Debt Prevention:** Addressing word segmentation accuracy now, especially concerning morphological boundaries, is vital. Incorrect segmentation can propagate errors throughout the learning process and undermine user trust in the app's reliability. It’s an investment in the app's data integrity and accuracy.\n*   **UI/UX Polish:** The spacing refinements are about achieving a professional and intuitive user interface. Small details in UI make a big difference in perceived quality and ease of use. A 'compact view' offers personalization and caters to different learning preferences.\n*   **Scalability for Future Features:** Establishing robust segmentation logic now will make it easier to build more advanced features later, such as interactive vocabulary lists or grammar explanations that rely on correctly parsed text.\n\n### How it serves the over-arching goals:\nThis epic serves to solidify the foundation of KanjiReader's utility. Without clear, readable text and reliable segmentation, the OCR and dictionary lookup features, no matter how accurate, lose their impact. By making the output more digestible and controllable, we enable learners to focus on the content itself rather than struggling with the presentation. This directly supports the goal of being an intuitive and reliable tool for Japanese learners.\n\n## Included Enhancements (from Openspec):\n\n### Spacing Refinement\n*   **Problem:** Excessive spacing between pronunciation/in-context text, and specifically huge gaps between morphemes in the 'Full text with pronunciation' view, creating a choppy and unnatural appearance.\n*   **Proposed Solution:** Implement CSS/style adjustments (margin, padding, line-height, letter-spacing) to reduce visual space, targeting inter-morpheme spacing for natural flow. Consider a 'compact view' toggle for minimal spacing.\n*   **Acceptance Criteria:** Minimized spacing without compromising clarity; layout consistency; elimination of excessive spaces in main components; natural flow in full text with pronunciation view; optional compact view toggle with further minimized spacing.\n\n## Audio Playback Controls\n*   **Problem:** No stop mechanism for audio playback, causing potential frustration and disorientation.\n*   **Proposed Solution:** Add a pause/stop button directly at the audio player's bar, ensuring immediate stop when interacted with. Implement hover elements for pause/play functionality within two taps of any UI component.\n*   **Acceptance Criteria:** Hover element for playback initiation within two taps; visible and interactive stop icon; user recording progress retained on navigation.\n\n## Improved Word Segmentation\n*   **Problem:** Incorrect splitting of conjugated verbs at morphological boundaries (e.g., '感じた' into '感じ' and 'た'), leading to grammatically incorrect and hard-to-read displays.\n*   **Proposed Solution:** Implement logic to correctly join verb stems with auxiliary endings and other common morphological units during display. This involves post-processing OCR output or refining morphological analysis.\n*   **Acceptance Criteria:** All word components correctly separate and link for proper meanings; phrases maintain clarity and grammatical correctness; segmentation verified by tests matching pre-established dictionaries/morphological analysis; conjugated Japanese verbs displayed as single, correctly formed words; segmentation prioritizes readability/grammatical correctness over strict morpheme-by-morpheme display.\n","status":"in_progress","priority":2,"issue_type":"epic","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-02-01T22:04:26.851001545+05:30","created_by":"krot","updated_at":"2026-02-02T13:00:09.739157231+05:30"}
{"id":"KanjiReader-zwg.1","title":"Spacing Refinement","description":"# Feature: Spacing Refinement\n\n### Problem:\nThe current display of pronunciation and in-context text within the KanjiReader app exhibits excessive spacing. This leads to a visually cluttered interface, making it difficult for users to quickly parse information and creating a less aesthetic user experience. Specifically, in the 'Full text with pronunciation' view, there are huge gaps between each morpheme (e.g., 'わたし は なに を し た の か それとも'), making the text appear choppy and unnatural. This hinders readability and the natural flow of Japanese text, especially for learners who rely on clear visual presentation.\n\n### Proposed Solution:\nImplement precise CSS/style adjustments to reduce the visual space between text elements. This effort will specifically target pronunciation guides and in-context sentence examples, as well as critically address inter-morpheme spacing. The objective is to create a more compact, natural-flowing, and readable layout without compromising clarity. This may involve fine-tuning `margin`, `padding`, `line-height`, or `letter-spacing` properties in the relevant UI components. Furthermore, consider introducing a 'compact view' toggle option for users who prefer an even more minimal spacing, allowing for personalized display preferences.\n\n### Acceptance Criteria:\n1.  **Minimized Spacing:** Spacing between pronunciation and reading must be minimized without detriment to meaning or clarity.\n2.  **Layout Consistency:** The overall layout and integrity of the display should not significantly change on screens that show both kanji and pronunciation parts together.\n3.  **Elimination of Excessive Spaces:** All excessive spaces, particularly in prominent text components like headers, sidebars, and the main content area, must be eliminated.\n4.  **Natural Flow (Default View):** The default display of the full text with pronunciation should exhibit a natural flow with significantly reduced inter-morpheme spacing, effectively avoiding the previously observed excessive visual gaps.\n5.  **Compact View Toggle (If Implemented):** If a compact view toggle is introduced, it must function correctly, effectively switching between default and a compact layout where spacing is further minimized.\n6.  **Readability:** The changes must enhance overall readability and reduce visual clutter for the user.\n\n### Background, Reasoning, and Considerations (for future self):\nFuture Rei, remember that this bead is crucial for user satisfaction and learning efficacy. Avinash's feedback directly highlighted the visual fatigue caused by current spacing. Our previous iterations resulted in text that looked more like individual blocks than fluid sentences. The 'compact view' idea stems from the understanding that different learners have different preferences for visual density. By giving users control, we cater to a wider audience. This isn't just about aesthetics; it's about improving cognitive load for learners. Reducing inter-morpheme gaps helps in perceiving words and phrases as cohesive units, which is fundamental to language acquisition. This foundational UI improvement will make subsequent enhancements more impactful. This work is a direct contribution to the parent epic's goal of a polished, user-friendly, and effective learning tool.\n","status":"in_progress","priority":2,"issue_type":"feature","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-02-01T22:05:41.713040543+05:30","created_by":"krot","updated_at":"2026-02-02T13:00:09.784860011+05:30","dependencies":[{"issue_id":"KanjiReader-zwg.1","depends_on_id":"KanjiReader-zwg","type":"parent-child","created_at":"2026-02-01T22:05:41.71410427+05:30","created_by":"krot"}]}
{"id":"KanjiReader-zwg.1.1","title":"Analyze current CSS/styling for text spacing","description":"## Task: Analyze Current CSS/Styling\n\n### Objective:\nConduct a thorough analysis of the existing CSS and styling rules that govern text spacing in the KanjiReader app, specifically targeting:\n- Pronunciation guides (furigana/romaji)\n- In-context sentence examples\n- Inter-morpheme spacing in the 'Full text with pronunciation' view\n\n### Background (for future self):\nBefore making any changes, we need to understand the current state. This task establishes a baseline and identifies exactly which CSS properties (margin, padding, line-height, letter-spacing) are responsible for the excessive spacing.\n\n### Deliverables:\n1. Document listing all relevant CSS selectors/rules affecting text spacing\n2. Screenshots/annotations showing current spacing issues\n3. Recommendations for which properties to adjust\n\n### Acceptance Criteria:\n- All CSS rules affecting text spacing are identified and documented\n- Root causes of excessive spacing are clearly understood","status":"open","priority":2,"issue_type":"task","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-02-01T22:11:11.877704536+05:30","created_by":"krot","updated_at":"2026-02-01T22:11:11.877704536+05:30","dependencies":[{"issue_id":"KanjiReader-zwg.1.1","depends_on_id":"KanjiReader-zwg.1","type":"parent-child","created_at":"2026-02-01T22:11:11.878732206+05:30","created_by":"krot"}]}
{"id":"KanjiReader-zwg.1.2","title":"Implement inter-morpheme spacing adjustments","description":"## Task: Implement Inter-Morpheme Spacing Adjustments\n\n### Objective:\nReduce the excessive gaps between morphemes in the 'Full text with pronunciation' view to create a more natural, readable text flow.\n\n### Background (for future self):\nThe screenshot showed text like 'わたし は なに を し た の か' with huge gaps between each morpheme. This makes reading feel choppy and unnatural. We need to tighten these spaces so the text flows like natural Japanese sentences while still maintaining visual separation for learning purposes.\n\n### Technical Approach:\n- Identify the React Native/CSS components rendering morpheme tokens\n- Adjust margin/padding between tokens\n- Ensure changes don't break layout on different screen sizes\n- Consider using flexbox gap properties for consistent spacing\n\n### Acceptance Criteria:\n- Inter-morpheme spacing is visually reduced\n- Text flows naturally without appearing cramped\n- Changes are consistent across all views displaying tokenized text\n\n### Dependencies:\n- Depends on: KanjiReader-zwg.1.1 (CSS analysis must be complete first)","status":"open","priority":2,"issue_type":"task","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-02-01T22:11:23.284981052+05:30","created_by":"krot","updated_at":"2026-02-01T22:11:23.284981052+05:30","dependencies":[{"issue_id":"KanjiReader-zwg.1.2","depends_on_id":"KanjiReader-zwg.1","type":"parent-child","created_at":"2026-02-01T22:11:23.286100768+05:30","created_by":"krot"},{"issue_id":"KanjiReader-zwg.1.2","depends_on_id":"KanjiReader-zwg.1.1","type":"blocks","created_at":"2026-02-01T22:11:23.287663519+05:30","created_by":"krot"}]}
{"id":"KanjiReader-zwg.1.3","title":"Implement pronunciation guide spacing adjustments","description":"## Task: Implement Pronunciation Guide Spacing Adjustments\n\n### Objective:\nReduce excessive spacing around pronunciation guides (romaji/readings) displayed alongside kanji/words in the results view.\n\n### Background (for future self):\nThe screenshot showed spacing around '(soretomo)' that was unnecessarily large, visually distancing the pronunciation from the word it describes. This disconnect makes it harder for learners to associate the reading with the kanji.\n\n### Technical Approach:\n- Target CSS for pronunciation/reading display components\n- Reduce vertical and horizontal margins/padding around pronunciation text\n- Maintain enough separation for clarity, but improve visual association with the main word\n- Test with different word lengths and pronunciation lengths\n\n### Acceptance Criteria:\n- Pronunciation guides appear visually connected to their corresponding words\n- Spacing is consistent regardless of word/pronunciation length\n- Readability is maintained or improved\n\n### Dependencies:\n- Depends on: KanjiReader-zwg.1.1 (CSS analysis must be complete first)","status":"open","priority":2,"issue_type":"task","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-02-01T22:11:32.879997763+05:30","created_by":"krot","updated_at":"2026-02-01T22:11:32.879997763+05:30","dependencies":[{"issue_id":"KanjiReader-zwg.1.3","depends_on_id":"KanjiReader-zwg.1","type":"parent-child","created_at":"2026-02-01T22:11:32.881064007+05:30","created_by":"krot"},{"issue_id":"KanjiReader-zwg.1.3","depends_on_id":"KanjiReader-zwg.1.1","type":"blocks","created_at":"2026-02-01T22:11:32.882614935+05:30","created_by":"krot"}]}
{"id":"KanjiReader-zwg.1.4","title":"Create compact view toggle UI","description":"## Task: Create Compact View Toggle UI\n\n### Objective:\nDesign and implement a user-accessible toggle that allows switching between 'default' and 'compact' display modes for text spacing.\n\n### Background (for future self):\nDifferent learners have different preferences for visual density. Some prefer more spacing for easier reading, while others want maximum information density. A toggle gives users control over their learning experience and demonstrates responsiveness to user needs.\n\n### Technical Approach:\n- Add a toggle switch/button in the settings or directly in the results view\n- Store user preference in app state/storage\n- Apply 'compact' CSS class when enabled, further reducing spacing\n- Ensure toggle state persists across app sessions\n\n### UI Considerations:\n- Toggle should be easily discoverable but not intrusive\n- Clear labeling: 'Compact View' or 'Dense Mode'\n- Consider adding a visual preview of the difference\n\n### Acceptance Criteria:\n- Toggle is visible and functional in the UI\n- Switching modes immediately updates the text display\n- User preference persists across sessions\n- Both modes provide readable, well-formatted text\n\n### Dependencies:\n- Depends on: KanjiReader-zwg.1.2, KanjiReader-zwg.1.3 (base spacing adjustments should be implemented first)","status":"open","priority":2,"issue_type":"task","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-02-01T22:11:43.791447584+05:30","created_by":"krot","updated_at":"2026-02-01T22:11:43.791447584+05:30","dependencies":[{"issue_id":"KanjiReader-zwg.1.4","depends_on_id":"KanjiReader-zwg.1","type":"parent-child","created_at":"2026-02-01T22:11:43.792481246+05:30","created_by":"krot"},{"issue_id":"KanjiReader-zwg.1.4","depends_on_id":"KanjiReader-zwg.1.2","type":"blocks","created_at":"2026-02-01T22:11:43.794180968+05:30","created_by":"krot"},{"issue_id":"KanjiReader-zwg.1.4","depends_on_id":"KanjiReader-zwg.1.3","type":"blocks","created_at":"2026-02-01T22:11:43.79578632+05:30","created_by":"krot"}]}
{"id":"KanjiReader-zwg.1.5","title":"Test spacing changes across screen sizes","description":"## Task: Test Spacing Changes Across Screen Sizes\n\n### Objective:\nVerify that all spacing adjustments work correctly across different device screen sizes and orientations.\n\n### Background (for future self):\nReact Native apps run on a variety of devices with different screen dimensions. Spacing that looks good on one device might look cramped or excessive on another. This testing task ensures our changes provide a consistent, quality experience everywhere.\n\n### Testing Scope:\n- Small phones (iPhone SE, small Android devices)\n- Standard phones (iPhone 14, Pixel 7)\n- Large phones/phablets (iPhone Pro Max, Samsung Ultra)\n- Tablets (iPad, Android tablets)\n- Both portrait and landscape orientations\n\n### Test Cases:\n1. Verify inter-morpheme spacing looks natural on all sizes\n2. Verify pronunciation guides are correctly associated with words\n3. Verify compact view toggle works and provides meaningful difference\n4. Check for text overflow or truncation issues\n5. Verify scrolling behavior with new spacing\n\n### Acceptance Criteria:\n- No visual regressions on any tested device size\n- Text remains readable and well-formatted across all sizes\n- Compact view provides consistent experience across devices\n\n### Dependencies:\n- Depends on: All spacing implementation tasks (KanjiReader-zwg.1.2, KanjiReader-zwg.1.3, KanjiReader-zwg.1.4)","status":"open","priority":2,"issue_type":"task","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-02-01T22:11:54.905943072+05:30","created_by":"krot","updated_at":"2026-02-01T22:11:54.905943072+05:30","dependencies":[{"issue_id":"KanjiReader-zwg.1.5","depends_on_id":"KanjiReader-zwg.1","type":"parent-child","created_at":"2026-02-01T22:11:54.906983176+05:30","created_by":"krot"},{"issue_id":"KanjiReader-zwg.1.5","depends_on_id":"KanjiReader-zwg.1.2","type":"blocks","created_at":"2026-02-01T22:11:54.908710742+05:30","created_by":"krot"},{"issue_id":"KanjiReader-zwg.1.5","depends_on_id":"KanjiReader-zwg.1.3","type":"blocks","created_at":"2026-02-01T22:11:54.910402278+05:30","created_by":"krot"},{"issue_id":"KanjiReader-zwg.1.5","depends_on_id":"KanjiReader-zwg.1.4","type":"blocks","created_at":"2026-02-01T22:11:54.912061804+05:30","created_by":"krot"}]}
{"id":"KanjiReader-zwg.2","title":"Audio Playback Control","description":"# Feature: Audio Playback Control\n\n### Problem:\nAudio playback currently lacks any stop mechanism once initiated, leading to potential user frustration and disorientation. Users are unable to pause or stop audio playback at will, which can disrupt their learning flow, especially when they need to concentrate, take notes, or navigate to other sections of the app. This is an oversight that compromises user control over their interactive experience with the application.\n\n### Proposed Solution:\nImplement a clear and accessible pause/stop button directly within the audio player's bar or near the audio initiation point. This button should allow for immediate cessation of audio playback upon interaction. Additionally, consider integrating a hover-activated control mechanism, allowing users to quickly and intuitively stop or pause audio within two taps of any UI component that triggers playback.\n\n### Acceptance Criteria:\n1.  **Stop Button:** A dedicated pause/stop button must be visibly present and functional in the audio player's UI.\n2.  **Immediate Control:** Interaction with the pause/stop button must result in the immediate cessation of audio playback.\n3.  **Hover/Tap Interaction (If Implemented):** If a hover-activated control is implemented, a hover element must appear within two taps of any UI component that initiates playback, offering a clear option to stop or pause.\n4.  **UI Feedback:** The stop icon or control should visually indicate the audio's current playing state (e.g., play/pause toggle).\n5.  **Progress Retention:** Users' learning progress or recording status shall not be lost when they navigate away from a page or stop audio playback, ensuring continuity.\n\n### Background:\nThe lack of a stop mechanism in audio playback has become pervasive due to auto-play features that typically start playing when landing on a webpage without user's knowledge or control; this can create confusion and frustration for users. While there are several workarounds available, each offering their own shortcomings like inability to easily recall or stop if not kept at the forefront of mind. Our proposal aims to tackle such issues by introducing an obvious 'Stop Button' directly beneath the audio player’s bar, ensuring immediate audio interruption when interacted with.  \n\n### Reasoning:\nIn a digital environment, information is often spread out across various pages and sections; without visual cues directing one to pause or stop an ongoing piece of content, navigation might get complicated and confusing. This proposal aims at rectifying such misconceptions through the introduction of this control enhancement feature which ensures users have immediate control over their audio playback experience, thus eliminating potential frustrations that could stem from auto-play features.  \n\n### Considerations:\nThe Stop Button's positioning directly under the UI would be beneficial as it can offer instant accessibility without overloading the user interface with unnecessary controls. The 'Stop' icon should also communicate itself clearly, indicating to users when audio is playing and what will happen on a tap of this icon (pause or stop the sound).  \n    \n### Contributing To Goals:\nThis feature enhancement directly contributes to improving the efficiency and user experience of the parent epic \"KanjiReader App Enhancements v1.0\" by providing an immediate control over the audio playback, increasing interaction with the UI interface thereby strengthening overall app usability in a user’s day-to-day activities within the app itself.\n","status":"in_progress","priority":2,"issue_type":"feature","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-02-01T22:08:59.533256133+05:30","created_by":"krot","updated_at":"2026-02-02T13:00:09.831101947+05:30","dependencies":[{"issue_id":"KanjiReader-zwg.2","depends_on_id":"KanjiReader-zwg","type":"parent-child","created_at":"2026-02-01T22:08:59.534384836+05:30","created_by":"krot"}]}
{"id":"KanjiReader-zwg.2.1","title":"Design pause/stop button UI","description":"## Task: Design Pause/Stop Button UI\n\n### Objective:\nDesign a clear, intuitive pause/stop button for the audio player that integrates seamlessly with the existing UI.\n\n### Background (for future self):\nCurrently, once audio starts playing, users have no way to stop it. This is a fundamental UX oversight. The solution needs to be obvious and immediately accessible - users shouldn't have to hunt for a stop button when audio is playing unexpectedly.\n\n### Design Requirements:\n- Button must be prominently visible when audio is playing\n- Use universally recognized pause/stop iconography\n- Button should indicate current audio state (playing/paused/stopped)\n- Placement should be near the audio initiation point (speaker icon)\n- Consider animation to draw attention when audio starts\n\n### Deliverables:\n1. UI mockup/design for the pause/stop button\n2. State diagram showing button appearance in different states\n3. Placement recommendations within existing UI\n\n### Acceptance Criteria:\n- Design is approved and documented\n- Button design is consistent with app's visual language\n- Button states (play/pause/stop) are visually distinct","status":"open","priority":2,"issue_type":"task","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-02-01T22:12:05.789164451+05:30","created_by":"krot","updated_at":"2026-02-01T22:12:05.789164451+05:30","dependencies":[{"issue_id":"KanjiReader-zwg.2.1","depends_on_id":"KanjiReader-zwg.2","type":"parent-child","created_at":"2026-02-01T22:12:05.790203503+05:30","created_by":"krot"}]}
{"id":"KanjiReader-zwg.2.2","title":"Implement audio stop functionality","description":"## Task: Implement Audio Stop Functionality\n\n### Objective:\nImplement the core functionality to stop/pause audio playback when the user interacts with the stop button.\n\n### Background (for future self):\nThis is the core technical implementation task. We need to hook into the existing audio playback system (likely using expo-av or react-native-sound) and add stop/pause capabilities.\n\n### Technical Approach:\n- Identify the current audio playback implementation\n- Add state management for audio playback status (playing/paused/stopped)\n- Implement stopAsync() or pauseAsync() methods on user interaction\n- Ensure audio resources are properly released when stopped\n- Handle edge cases (stopping when already stopped, rapid play/stop cycles)\n\n### Code Considerations:\n- Use proper async/await patterns for audio control\n- Implement error handling for playback failures\n- Consider adding a global audio manager if multiple audio sources exist\n\n### Acceptance Criteria:\n- Tapping stop immediately halts audio playback\n- Audio state is correctly tracked and reflected in UI\n- No memory leaks from unreleased audio resources\n- Works consistently across iOS and Android\n\n### Dependencies:\n- Depends on: KanjiReader-zwg.2.1 (UI design should be finalized first)","status":"open","priority":2,"issue_type":"task","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-02-01T22:12:17.079814547+05:30","created_by":"krot","updated_at":"2026-02-01T22:12:17.079814547+05:30","dependencies":[{"issue_id":"KanjiReader-zwg.2.2","depends_on_id":"KanjiReader-zwg.2","type":"parent-child","created_at":"2026-02-01T22:12:17.080883316+05:30","created_by":"krot"},{"issue_id":"KanjiReader-zwg.2.2","depends_on_id":"KanjiReader-zwg.2.1","type":"blocks","created_at":"2026-02-01T22:12:17.082560405+05:30","created_by":"krot"}]}
{"id":"KanjiReader-zwg.2.3","title":"Integrate stop button with UI","description":"## Task: Integrate Stop Button with UI\n\n### Objective:\nImplement the designed pause/stop button into the app's UI and connect it to the audio stop functionality.\n\n### Background (for future self):\nThis task bridges the design (KanjiReader-zwg.2.1) and implementation (KanjiReader-zwg.2.2) tasks. It involves creating the actual React Native components and wiring them to the audio control logic.\n\n### Technical Approach:\n- Create React Native component for the stop button\n- Implement state-based rendering (show different icons for play/pause/stop states)\n- Add touch handlers that trigger audio stop/pause functions\n- Add appropriate animations/transitions for state changes\n- Ensure button is accessible (proper hit area, accessibility labels)\n\n### UI Integration Points:\n- Near the existing speaker/audio icon in results view\n- Possibly in a floating audio control bar if audio is playing\n\n### Acceptance Criteria:\n- Button appears in the correct location per design\n- Button correctly reflects audio playback state\n- Tapping button successfully stops/pauses audio\n- Button is accessible and has appropriate touch targets\n\n### Dependencies:\n- Depends on: KanjiReader-zwg.2.1 (UI design), KanjiReader-zwg.2.2 (audio functionality)","status":"open","priority":2,"issue_type":"task","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-02-01T22:12:27.34625852+05:30","created_by":"krot","updated_at":"2026-02-01T22:12:27.34625852+05:30","dependencies":[{"issue_id":"KanjiReader-zwg.2.3","depends_on_id":"KanjiReader-zwg.2","type":"parent-child","created_at":"2026-02-01T22:12:27.347470161+05:30","created_by":"krot"},{"issue_id":"KanjiReader-zwg.2.3","depends_on_id":"KanjiReader-zwg.2.1","type":"blocks","created_at":"2026-02-01T22:12:27.349326041+05:30","created_by":"krot"},{"issue_id":"KanjiReader-zwg.2.3","depends_on_id":"KanjiReader-zwg.2.2","type":"blocks","created_at":"2026-02-01T22:12:27.351129341+05:30","created_by":"krot"}]}
{"id":"KanjiReader-zwg.2.4","title":"Verify audio state persistence on navigation","description":"## Task: Verify Audio State Persistence on Navigation\n\n### Objective:\nEnsure that users' audio playback state and any recording progress is properly handled when navigating away from a page.\n\n### Background (for future self):\nOne of the acceptance criteria from the openspec states: 'Users' recording progress shall not lose when they navigate away from the page, ensuring continuity throughout their learning experience.' This task verifies that behavior is correct.\n\n### Test Scenarios:\n1. Audio playing → Navigate away → Return: What happens?\n2. Audio paused → Navigate away → Return: Is pause state preserved?\n3. If there's any recording feature: Is progress saved?\n4. Background/foreground app transitions: How does audio behave?\n\n### Technical Considerations:\n- May need to implement audio session management\n- Consider whether audio should continue in background or pause\n- State persistence might require local storage or context management\n\n### Acceptance Criteria:\n- Audio behavior on navigation is intentional and documented\n- No unexpected audio continuation after leaving a screen\n- Any user progress is preserved as per design decisions\n- App handles background/foreground transitions gracefully\n\n### Dependencies:\n- Depends on: KanjiReader-zwg.2.3 (full audio control integration)","status":"open","priority":2,"issue_type":"task","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-02-01T22:12:39.255332335+05:30","created_by":"krot","updated_at":"2026-02-01T22:12:39.255332335+05:30","dependencies":[{"issue_id":"KanjiReader-zwg.2.4","depends_on_id":"KanjiReader-zwg.2","type":"parent-child","created_at":"2026-02-01T22:12:39.256463112+05:30","created_by":"krot"},{"issue_id":"KanjiReader-zwg.2.4","depends_on_id":"KanjiReader-zwg.2.3","type":"blocks","created_at":"2026-02-01T22:12:39.258325145+05:30","created_by":"krot"}]}
{"id":"KanjiReader-zwg.3","title":"Improved Word Segmentation","description":"# Feature: Improved Word Segmentation\n\n### Problem:\nThe current app struggles with accurate word segmentation for complex Japanese text. While basic words like '感じ' (to perceive) are handled correctly, conjugated verbs are incorrectly split at morphological boundaries. Examples include:\n- '感じた' split into '感じ' and 'た'\n- '思い出して' split into '思い出し' and 'て'\n- '書こう' split into '書こ' and 'う'\n\nThis results in grammatically incorrect and visually fragmented displays, significantly hindering readability and comprehension for Japanese language learners. The core issue is that the current tokenization/segmentation logic treats each morpheme as a separate display unit, which is technically correct but pedagogically unhelpful.\n\n### Proposed Solution:\nImplement intelligent post-processing logic that correctly joins verb stems with their auxiliary endings and other morphologically linked units during display. This solution will involve:\n1. **Dictionary Lookup Enhancement:** Cross-reference segmented tokens against a dictionary of common verb conjugations and compound forms.\n2. **Morphological Analysis Refinement:** Improve the morphological analysis step to recognize when adjacent morphemes should be displayed as a single unit.\n3. **Post-OCR Processing:** Apply rules to rejoin incorrectly split conjugated verbs and other grammatical units after initial OCR processing.\n\nThe goal is to prioritize readability and grammatical correctness for the learner, even if it means deviating from a strict morpheme-by-morpheme split in the display.\n\n### Acceptance Criteria:\n1. **Correct Separation \u0026 Linking:** All word components should correctly separate and link together for their proper meanings.\n2. **Maintained Context:** Phrases that are split up will maintain their correct pronunciation, meaning, and grammatical context.\n3. **Robustness Testing:** The improvement in segmentation can be verified with sets of tests involving various sentence structure inputs to test its robustness. These segmentations must match pre-established dictionaries or have good morphological analysis results (e.g., correct verb stems and auxiliaries joining).\n4. **Single-Word Display:** Conjugated Japanese verbs and other morphologically linked units (e.g., verb stems and auxiliary endings) must be displayed as single, correctly formed words (e.g., '感じた' instead of '感じ た').\n5. **Readability Priority:** The segmentation should prioritize readability and grammatical correctness for the learner, even if it means deviating from a strict morpheme-by-morpheme split in the display.\n\n### Background \u0026 Reasoning (for future self):\nFuture Rei, this is arguably the most technically challenging enhancement in this epic, but also the most impactful for learning efficacy. Avinash specifically pointed out the '感じた' → '感じ' + 'た' split issue. Remember that Japanese learners, especially beginners, rely heavily on seeing words as cohesive units to build vocabulary and grammar intuition. By fragmenting conjugated verbs, we're inadvertently teaching incorrect word boundaries.\n\nThis solution not only mitigates OCR errors but also assists in preserving more accurate and meaningful contextual relevance, thereby improving user experience overall. This feature contributes to the goals of enhancing communication understanding among learners, particularly for those who are studying Japanese language with its complex morphological structures.\n\n### Considerations:\n- **Performance:** The post-processing logic must be efficient to avoid noticeable delays in displaying results.\n- **Edge Cases:** Japanese has many irregular conjugations and compound forms; a comprehensive rule set or dictionary is needed.\n- **Trade-offs:** In some cases, a strict morpheme split might be pedagogically useful (e.g., for advanced learners studying grammar). Consider whether to offer a toggle for \"detailed view\" in the future.\n- **Testing:** A robust test suite with diverse sentence structures is essential to validate segmentation accuracy.\n\n### Contributing to Parent Epic Goals:\nThis feature directly addresses one of the core user experience issues identified in the \"KanjiReader App Enhancements v1.0\" epic. By ensuring that displayed text is grammatically correct and readable, we significantly improve the app's pedagogical value and user trust. This is foundational work that makes the OCR and dictionary lookup features truly useful for learners.\n","status":"closed","priority":2,"issue_type":"feature","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-02-01T22:10:54.195598133+05:30","created_by":"krot","updated_at":"2026-02-02T13:03:29.423984819+05:30","closed_at":"2026-02-02T13:03:29.423987684+05:30","dependencies":[{"issue_id":"KanjiReader-zwg.3","depends_on_id":"KanjiReader-zwg","type":"parent-child","created_at":"2026-02-01T22:10:54.196706266+05:30","created_by":"krot"}]}
{"id":"KanjiReader-zwg.3.1","title":"Analyze current tokenization/segmentation logic","description":"## Task: Analyze Current Tokenization/Segmentation Logic\n\n### Objective:\nConduct a thorough analysis of how the app currently tokenizes and segments Japanese text to understand where and why incorrect splits occur.\n\n### Background (for future self):\nBefore we can fix the segmentation, we need to understand the current implementation. Is tokenization happening during OCR? Is there a separate NLP step? What libraries are being used (if any)? This analysis will inform our solution approach.\n\n### Investigation Areas:\n1. OCR pipeline: Does Google Cloud Vision return tokenized text or raw text?\n2. Post-OCR processing: Is there any existing segmentation logic?\n3. Dictionary lookup: How are individual tokens matched to dictionary entries?\n4. Display rendering: At what point are tokens separated for display?\n\n### Specific Questions to Answer:\n- Where does '感じた' get split into '感じ' and 'た'?\n- Is this split coming from OCR, a tokenizer library, or our own code?\n- What data structure represents tokenized text?\n\n### Deliverables:\n1. Documentation of current text processing pipeline\n2. Identification of the exact point where incorrect segmentation occurs\n3. Recommendations for where to implement fixes\n\n### Acceptance Criteria:\n- Current tokenization flow is fully documented\n- Root cause of incorrect segmentation is identified\n- Clear path forward for implementing fixes is defined","status":"closed","priority":2,"issue_type":"task","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-02-01T22:12:50.927054099+05:30","created_by":"krot","updated_at":"2026-02-02T13:02:51.182015852+05:30","closed_at":"2026-02-02T13:02:51.182019519+05:30","dependencies":[{"issue_id":"KanjiReader-zwg.3.1","depends_on_id":"KanjiReader-zwg.3","type":"parent-child","created_at":"2026-02-01T22:12:50.928572275+05:30","created_by":"krot"}]}
{"id":"KanjiReader-zwg.3.2","title":"Research morphological joining rules for Japanese verbs","description":"## Task: Research Morphological Joining Rules for Japanese Verbs\n\n### Objective:\nCompile a comprehensive set of rules for when Japanese morphemes should be joined for display purposes, focusing on verb conjugations.\n\n### Background (for future self):\nJapanese verb conjugation follows predictable patterns. 'た' (past tense), 'て' (te-form), 'ない' (negative), 'う' (volitional), etc., are auxiliary endings that should generally be displayed attached to their verb stems. We need to codify these rules.\n\n### Research Areas:\n1. Verb conjugation patterns (godan, ichidan, irregular)\n2. Common auxiliary endings and their joining behavior\n3. Compound verbs and their segmentation\n4. Adjective conjugations (i-adjectives, na-adjectives)\n5. Edge cases and exceptions\n\n### Example Rules to Define:\n- Verb stem + た → Join (感じ + た → 感じた)\n- Verb stem + て → Join (思い出し + て → 思い出して)\n- Verb stem + う/よう → Join (書こ + う → 書こう)\n- Verb stem + ない → Join (食べ + ない → 食べない)\n\n### Deliverables:\n1. Documented list of morpheme joining rules\n2. Categorization by verb type and conjugation pattern\n3. List of known exceptions and edge cases\n\n### Acceptance Criteria:\n- Rules cover common verb conjugation patterns\n- Rules are validated against Japanese grammar references\n- Edge cases are identified and documented\n\n### Dependencies:\n- Depends on: KanjiReader-zwg.3.1 (understanding current logic helps prioritize rules)","status":"closed","priority":2,"issue_type":"task","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-02-01T22:13:06.906420272+05:30","created_by":"krot","updated_at":"2026-02-02T13:02:51.232826129+05:30","closed_at":"2026-02-02T13:02:51.232829696+05:30","dependencies":[{"issue_id":"KanjiReader-zwg.3.2","depends_on_id":"KanjiReader-zwg.3","type":"parent-child","created_at":"2026-02-01T22:13:06.907495403+05:30","created_by":"krot"},{"issue_id":"KanjiReader-zwg.3.2","depends_on_id":"KanjiReader-zwg.3.1","type":"blocks","created_at":"2026-02-01T22:13:06.909384657+05:30","created_by":"krot"}]}
{"id":"KanjiReader-zwg.3.3","title":"Implement post-processing morpheme joining logic","description":"## Task: Implement Post-Processing Morpheme Joining Logic\n\n### Objective:\nImplement the core algorithm that joins incorrectly split morphemes based on the researched rules.\n\n### Background (for future self):\nThis is the main implementation task. Based on our analysis and research, we'll implement logic that takes the tokenized text and intelligently joins tokens that should be displayed as single words.\n\n### Technical Approach:\n1. Create a function that takes an array of tokens as input\n2. Iterate through tokens, checking if adjacent tokens should be joined\n3. Apply joining rules based on token types (verb stem, auxiliary, particle, etc.)\n4. Return the corrected token array for display\n\n### Pseudocode Concept:\n```\nfunction joinMorphemes(tokens):\n  result = []\n  i = 0\n  while i \u003c tokens.length:\n    if shouldJoin(tokens[i], tokens[i+1]):\n      result.push(tokens[i] + tokens[i+1])\n      i += 2\n    else:\n      result.push(tokens[i])\n      i += 1\n  return result\n```\n\n### Implementation Considerations:\n- Tokens may need part-of-speech tagging to determine join eligibility\n- Consider using existing Japanese NLP libraries (kuromoji, etc.) if available\n- Performance: joining should be fast enough for real-time display\n- Handle multi-token joins (e.g., verb + auxiliary + particle sequences)\n\n### Acceptance Criteria:\n- '感じた' displays as '感じた' not '感じ た'\n- '思い出して' displays as '思い出して' not '思い出し て'\n- '書こう' displays as '書こう' not '書こ う'\n- Other common conjugations are correctly joined\n- No false positives (tokens that shouldn't be joined aren't joined)\n\n### Dependencies:\n- Depends on: KanjiReader-zwg.3.1 (analysis), KanjiReader-zwg.3.2 (rules research)","status":"closed","priority":2,"issue_type":"task","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-02-01T22:13:18.995210567+05:30","created_by":"krot","updated_at":"2026-02-02T13:02:51.280150187+05:30","closed_at":"2026-02-02T13:02:51.280153974+05:30","dependencies":[{"issue_id":"KanjiReader-zwg.3.3","depends_on_id":"KanjiReader-zwg.3","type":"parent-child","created_at":"2026-02-01T22:13:18.996728634+05:30","created_by":"krot"},{"issue_id":"KanjiReader-zwg.3.3","depends_on_id":"KanjiReader-zwg.3.1","type":"blocks","created_at":"2026-02-01T22:13:18.999497867+05:30","created_by":"krot"},{"issue_id":"KanjiReader-zwg.3.3","depends_on_id":"KanjiReader-zwg.3.2","type":"blocks","created_at":"2026-02-01T22:13:19.002473203+05:30","created_by":"krot"}]}
{"id":"KanjiReader-zwg.3.4","title":"Create segmentation validation suite","description":"## Task: Create Segmentation Validation Test Suite\n\n### Objective:\nCreate a comprehensive test suite to validate that segmentation improvements work correctly across a variety of sentence structures.\n\n### Background (for future self):\nThe acceptance criteria specifically require: 'The improvement in segmentation can be verified with sets of tests involving various sentence structure inputs.' This task ensures we have robust testing to catch regressions and validate correctness.\n\n### Test Categories:\n1. **Basic verb conjugations:**\n   - 食べた, 飲んだ, 行った (ta-form)\n   - 食べて, 飲んで, 行って (te-form)\n   - 食べよう, 飲もう, 行こう (volitional)\n   - 食べない, 飲まない, 行かない (negative)\n\n2. **Compound verbs:**\n   - 思い出す, 走り出す, 飛び込む\n\n3. **Adjective conjugations:**\n   - 高かった, 静かだった\n\n4. **Complex sentences:**\n   - Multiple conjugated verbs in sequence\n   - Nested clauses\n\n5. **Edge cases:**\n   - Irregular verbs (する, くる)\n   - Potential forms\n   - Causative/passive forms\n\n### Deliverables:\n1. Test file with comprehensive test cases\n2. Expected output for each test case\n3. Automated test runner (if applicable)\n\n### Acceptance Criteria:\n- Test suite covers all common conjugation patterns\n- Tests are automated and can be run as part of CI/CD\n- All tests pass with the implemented joining logic\n\n### Dependencies:\n- Depends on: KanjiReader-zwg.3.3 (implementation must exist to test)","status":"closed","priority":2,"issue_type":"task","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-02-01T22:13:31.112734362+05:30","created_by":"krot","updated_at":"2026-02-02T13:02:51.325484751+05:30","closed_at":"2026-02-02T13:02:51.325487537+05:30","dependencies":[{"issue_id":"KanjiReader-zwg.3.4","depends_on_id":"KanjiReader-zwg.3","type":"parent-child","created_at":"2026-02-01T22:13:31.113854208+05:30","created_by":"krot"},{"issue_id":"KanjiReader-zwg.3.4","depends_on_id":"KanjiReader-zwg.3.3","type":"blocks","created_at":"2026-02-01T22:13:31.115869773+05:30","created_by":"krot"}]}
{"id":"KanjiReader-zwg.3.5","title":"Integration testing with real OCR output","description":"## Task: Integration Testing with Real OCR Output\n\n### Objective:\nTest the improved segmentation logic with actual OCR output from Google Cloud Vision to ensure it works correctly in the real app context.\n\n### Background (for future self):\nUnit tests with predefined inputs are important, but the real test is how the logic performs with actual OCR output. OCR can introduce its own quirks (misrecognitions, unexpected tokenization), and we need to ensure our improvements handle these gracefully.\n\n### Testing Approach:\n1. Capture several real OCR outputs from the app (using existing test images)\n2. Run the improved segmentation logic on these outputs\n3. Manually verify the results are correct\n4. Document any edge cases or failures\n\n### Test Images to Use:\n- The original screenshot Avinash provided\n- Additional handwritten Japanese samples\n- Printed Japanese text samples\n- Mixed content (kanji, hiragana, katakana)\n\n### Acceptance Criteria:\n- Segmentation works correctly with actual OCR output\n- No regressions compared to previous behavior (except intentional fixes)\n- Edge cases from real OCR are handled or documented\n- Performance is acceptable (no noticeable delays)\n\n### Dependencies:\n- Depends on: KanjiReader-zwg.3.3 (implementation), KanjiReader-zwg.3.4 (unit tests)","status":"closed","priority":2,"issue_type":"task","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-02-01T22:13:42.482109183+05:30","created_by":"krot","updated_at":"2026-02-02T13:03:29.381329055+05:30","closed_at":"2026-02-02T13:03:29.38133194+05:30","dependencies":[{"issue_id":"KanjiReader-zwg.3.5","depends_on_id":"KanjiReader-zwg.3","type":"parent-child","created_at":"2026-02-01T22:13:42.483600087+05:30","created_by":"krot"},{"issue_id":"KanjiReader-zwg.3.5","depends_on_id":"KanjiReader-zwg.3.3","type":"blocks","created_at":"2026-02-01T22:13:42.48664163+05:30","created_by":"krot"},{"issue_id":"KanjiReader-zwg.3.5","depends_on_id":"KanjiReader-zwg.3.4","type":"blocks","created_at":"2026-02-01T22:13:42.489658515+05:30","created_by":"krot"}]}
