{"id":"kanji-reader-xwj","title":"MVP KanjiReader - Japanese Kanji Learning App","description":"# KanjiReader MVP\n\n## Vision\nTransform passive Japanese consumption (reading, watching) into active learning. Help learners SEE, HEAR, and UNDERSTAND Japanese characters in context.\n\n## Problem\nTranslation tools show English meanings but don't teach Kanji recognition or pronunciation. Users understand content but never learn to read Japanese independently.\n\n## Solution\nMobile app that:\n1. Captures/uploads images of Japanese text\n2. OCR identifies Kanji, Hiragana, Katakana\n3. Segments text into words (not characters - meanings change with context)\n4. Provides pronunciation via TTS\n5. Shows romaji + English meanings\n\n## Target User\nAvinash - Developer learning Japanese, has ADHD (needs quick interactions, minimal friction)\n\n## Tech Stack\n- React Native + Expo (managed workflow)\n- Google Cloud Vision API (OCR)\n- Jisho API (dictionary)\n- Expo Speech (TTS - primary, free, offline)\n- Zustand (state management)\n\n## Platform\n- Primary: iOS (iPhone)\n- Secondary: Android\n- Distribution: Local install only (TestFlight/.ipa/.apk)\n\n## Key Decisions\n- Word-level display (not character-level) - Kanji meanings change with words\n- Full text visible in results - see complete sentence\n- Expo Speech primary - free, no API costs, works offline\n- No region selection MVP - full capture, smart OCR\n- Cache for performance, not full offline mode\n\n## Success Criteria\n- Full flow works: capture → OCR → segment → display → pronounce\n- App installs on physical iPhone/Android\n- Japanese pronunciation is clear and correct\n- ADHD-friendly: quick interactions, immediate feedback\n\n## References\n- openspec/changes/mvp-kanji-reader/proposal.md\n- openspec/changes/mvp-kanji-reader/tasks.md\n- openspec/specs/*.md","status":"open","priority":1,"issue_type":"epic","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-01-30T18:45:41.513333007+05:30","created_by":"krot","updated_at":"2026-01-30T18:45:41.513333007+05:30","labels":["epic","japanese","mobile","mvp"]}
{"id":"kanji-reader-xwj.1","title":"Phase 1: Project Setup \u0026 Foundation","description":"# Phase 1: Project Setup \u0026 Foundation\n\n## Purpose\nEstablish the foundational structure for the KanjiReader app. This phase MUST complete before any feature development begins.\n\n## Why This Matters\n- Proper project structure prevents tech debt accumulation\n- TypeScript + ESLint catch bugs early\n- Base components ensure UI consistency\n- EAS configuration enables device testing\n\n## Deliverables\n1. Expo project with TypeScript\n2. Folder structure (src/, components/, services/, etc.)\n3. ESLint + Prettier configuration\n4. Base UI components (Button, Card, Loading, ErrorBoundary)\n5. Theme system (colors, typography)\n6. EAS Build profiles for local distribution\n7. Environment variable setup\n\n## Technical Decisions\n- Expo managed workflow (not bare) - faster iteration, easier camera access\n- pnpm for package management\n- Zustand for state (simpler than Redux for ADHD-friendly codebase)\n- TypeScript strict mode\n\n## Dependencies\nNone - this is the foundation.\n\n## Acceptance Criteria\n- [ ] App runs in Expo Go\n- [ ] TypeScript compiles without errors\n- [ ] ESLint passes with zero warnings\n- [ ] Base components render correctly\n- [ ] EAS builds successfully for iOS and Android","status":"open","priority":1,"issue_type":"feature","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-01-30T18:45:55.76942759+05:30","created_by":"krot","updated_at":"2026-01-30T18:45:55.76942759+05:30","labels":["foundation","phase","setup"],"dependencies":[{"issue_id":"kanji-reader-xwj.1","depends_on_id":"kanji-reader-xwj","type":"parent-child","created_at":"2026-01-30T18:45:55.771062226+05:30","created_by":"krot"}]}
{"id":"kanji-reader-xwj.1.1","title":"Initialize Expo Project with TypeScript","description":"# Initialize Expo Project\n\n## Task\nCreate new Expo project using TypeScript template.\n\n## Commands\n```bash\nnpx create-expo-app@latest kanji-reader --template blank-typescript\ncd kanji-reader\n```\n\n## Folder Structure to Create\n```\nsrc/\n├── components/     # Reusable UI components\n├── screens/        # Screen components\n├── services/       # API/business logic\n├── hooks/          # Custom React hooks\n├── utils/          # Helper functions\n├── types/          # TypeScript types\n├── constants/      # App constants\n└── store/          # Zustand stores\nassets/             # Images, fonts\n```\n\n## Why This Structure\n- Separation of concerns\n- Easy to navigate for ADHD brain\n- Scales well as app grows\n- Common React Native convention\n\n## Acceptance Criteria\n- [ ] Expo project created\n- [ ] TypeScript configured\n- [ ] Folder structure in place\n- [ ] App runs with 'npx expo start'","status":"closed","priority":1,"issue_type":"task","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-01-30T18:46:08.374837664+05:30","created_by":"krot","updated_at":"2026-01-30T19:05:55.442912951+05:30","closed_at":"2026-01-30T19:05:55.442912951+05:30","close_reason":"Closed","labels":["expo","setup","typescript"],"dependencies":[{"issue_id":"kanji-reader-xwj.1.1","depends_on_id":"kanji-reader-xwj.1","type":"parent-child","created_at":"2026-01-30T18:46:08.375996539+05:30","created_by":"krot"}]}
{"id":"kanji-reader-xwj.1.2","title":"Configure ESLint and Prettier","description":"# Configure Linting \u0026 Formatting\n\n## Task\nSet up ESLint and Prettier for consistent code quality.\n\n## Packages to Install\n```bash\npnpm add -D eslint prettier eslint-config-expo eslint-plugin-react-hooks @typescript-eslint/parser @typescript-eslint/eslint-plugin\n```\n\n## Configuration Files\n- .eslintrc.js - ESLint rules\n- .prettierrc - Prettier formatting\n- .eslintignore - Exclude node_modules, build\n\n## Key Rules\n- React Hooks rules enabled\n- TypeScript strict checks\n- Single quotes, no semicolons (preference)\n- 2-space indentation\n\n## Why This Matters\n- Consistent code style across all files\n- Catches bugs before runtime\n- Makes code reviews easier\n- Reduces cognitive load when reading code\n\n## Acceptance Criteria\n- [ ] ESLint runs without errors\n- [ ] Prettier formats all files\n- [ ] VS Code integration works\n- [ ] Pre-commit hook optional","status":"open","priority":2,"issue_type":"task","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-01-30T18:46:16.149297584+05:30","created_by":"krot","updated_at":"2026-01-30T18:46:16.149297584+05:30","labels":["dx","setup","tooling"],"dependencies":[{"issue_id":"kanji-reader-xwj.1.2","depends_on_id":"kanji-reader-xwj.1","type":"parent-child","created_at":"2026-01-30T18:46:16.150616084+05:30","created_by":"krot"},{"issue_id":"kanji-reader-xwj.1.2","depends_on_id":"kanji-reader-xwj.1.1","type":"blocks","created_at":"2026-01-30T18:47:00.724705047+05:30","created_by":"krot"}]}
{"id":"kanji-reader-xwj.1.3","title":"Set up Environment Variables","description":"# Environment Variables Setup\n\n## Task\nConfigure environment variables for API keys and config.\n\n## Packages\n```bash\npnpm add expo-constants\n```\n\n## Files to Create\n- .env.example (template, committed)\n- .env (actual values, gitignored)\n- src/constants/config.ts (typed access)\n\n## Variables Needed\n```\nGOOGLE_CLOUD_VISION_API_KEY=xxx\n# Future: GOOGLE_CLOUD_TTS_API_KEY=xxx (v2)\n```\n\n## Why\n- Keep secrets out of code\n- Easy to switch between dev/prod\n- Required for Google Cloud Vision OCR\n\n## Security Note\n.env MUST be in .gitignore - never commit API keys.\n\n## Acceptance Criteria\n- [ ] .env.example exists with placeholders\n- [ ] .env is gitignored\n- [ ] Config module provides typed access\n- [ ] App reads env vars correctly","status":"open","priority":2,"issue_type":"task","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-01-30T18:46:24.092635415+05:30","created_by":"krot","updated_at":"2026-01-30T18:46:24.092635415+05:30","labels":["config","security","setup"],"dependencies":[{"issue_id":"kanji-reader-xwj.1.3","depends_on_id":"kanji-reader-xwj.1","type":"parent-child","created_at":"2026-01-30T18:46:24.093725719+05:30","created_by":"krot"},{"issue_id":"kanji-reader-xwj.1.3","depends_on_id":"kanji-reader-xwj.1.1","type":"blocks","created_at":"2026-01-30T18:47:00.757683924+05:30","created_by":"krot"}]}
{"id":"kanji-reader-xwj.1.4","title":"Create Theme System","description":"# Theme System\n\n## Task\nCreate consistent design tokens and theme provider.\n\n## Files\n- src/constants/colors.ts\n- src/constants/typography.ts\n- src/constants/spacing.ts\n- src/context/ThemeContext.tsx (optional for dark mode later)\n\n## Color Palette\n```typescript\nexport const colors = {\n  // Character type colors (core to app identity)\n  kanji: '#3B82F6',      // Blue\n  hiragana: '#10B981',   // Green\n  katakana: '#F59E0B',   // Orange\n  romaji: '#6B7280',     // Gray\n  \n  // UI colors\n  primary: '#3B82F6',\n  background: '#FFFFFF',\n  surface: '#F3F4F6',\n  text: '#1F2937',\n  textSecondary: '#6B7280',\n  error: '#EF4444',\n  success: '#10B981',\n}\n```\n\n## Typography\n- Font: System default (fastest load)\n- Sizes: 12, 14, 16, 20, 24, 32\n- Japanese text needs larger sizes for readability\n\n## Why These Colors\n- Character type colors are THE learning signal\n- Blue/green/orange easily distinguishable\n- Consistent with proposal.md decisions\n\n## Acceptance Criteria\n- [ ] Colors exported and typed\n- [ ] Typography scale defined\n- [ ] Spacing scale defined (4, 8, 12, 16, 24, 32)\n- [ ] Used consistently across components","status":"open","priority":2,"issue_type":"task","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-01-30T18:46:33.975040331+05:30","created_by":"krot","updated_at":"2026-01-30T18:46:33.975040331+05:30","labels":["design","setup","ui"],"dependencies":[{"issue_id":"kanji-reader-xwj.1.4","depends_on_id":"kanji-reader-xwj.1","type":"parent-child","created_at":"2026-01-30T18:46:33.976100949+05:30","created_by":"krot"},{"issue_id":"kanji-reader-xwj.1.4","depends_on_id":"kanji-reader-xwj.1.1","type":"blocks","created_at":"2026-01-30T18:47:00.79207023+05:30","created_by":"krot"}]}
{"id":"kanji-reader-xwj.1.5","title":"Create Base UI Components","description":"# Base UI Components\n\n## Task\nBuild reusable foundational components for consistent UI.\n\n## Components to Create\n\n### Button (src/components/Button.tsx)\n- Primary and secondary variants\n- Loading state with spinner\n- Disabled state\n- Full-width option\n- Haptic feedback on press\n\n### Card (src/components/Card.tsx)\n- Elevated surface with shadow\n- Pressable variant (for WordCard later)\n- Selected state styling\n\n### Loading (src/components/Loading.tsx)\n- Full-screen loading overlay\n- Inline loading indicator\n- Shimmer/skeleton variant\n\n### ErrorBoundary (src/components/ErrorBoundary.tsx)\n- Catches render errors\n- Shows friendly error message\n- Retry button\n- Logs error for debugging\n\n## Design Principles\n- ADHD-friendly: Clear visual feedback\n- Touch targets: Minimum 44x44 points\n- Consistent with theme colors\n\n## Why Base Components First\n- Ensures UI consistency from start\n- Faster feature development\n- Single source of truth for styling\n\n## Acceptance Criteria\n- [ ] All 4 components created\n- [ ] TypeScript props properly typed\n- [ ] Uses theme colors/spacing\n- [ ] Basic tests pass","status":"open","priority":2,"issue_type":"task","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-01-30T18:46:43.407747779+05:30","created_by":"krot","updated_at":"2026-01-30T18:46:43.407747779+05:30","labels":["components","setup","ui"],"dependencies":[{"issue_id":"kanji-reader-xwj.1.5","depends_on_id":"kanji-reader-xwj.1","type":"parent-child","created_at":"2026-01-30T18:46:43.408839175+05:30","created_by":"krot"},{"issue_id":"kanji-reader-xwj.1.5","depends_on_id":"kanji-reader-xwj.1.4","type":"blocks","created_at":"2026-01-30T18:47:00.825756619+05:30","created_by":"krot"}]}
{"id":"kanji-reader-xwj.1.6","title":"Configure EAS Build for Local Distribution","description":"# EAS Build Configuration\n\n## Task\nSet up Expo Application Services (EAS) for building installable apps.\n\n## Why EAS\n- Official Expo build service\n- Handles iOS signing complexity\n- Free tier sufficient for personal use\n- Outputs .ipa (iOS) and .apk (Android)\n\n## Setup Steps\n```bash\n# Install EAS CLI\nnpm install -g eas-cli\n\n# Login to Expo\neas login\n\n# Initialize EAS in project\neas init\n\n# Create eas.json\n```\n\n## eas.json Configuration\n```json\n{\n  \"build\": {\n    \"development\": {\n      \"developmentClient\": true,\n      \"distribution\": \"internal\"\n    },\n    \"preview\": {\n      \"distribution\": \"internal\",\n      \"ios\": {\n        \"simulator\": false\n      }\n    },\n    \"production\": {\n      \"distribution\": \"internal\"\n    }\n  }\n}\n```\n\n## iOS Specific\n- Requires Apple Developer account (9/year)\n- Ad-hoc provisioning for local install\n- Register device UDIDs\n\n## Android Specific\n- No account needed for .apk\n- Enable 'Unknown sources' to install\n\n## Test Commands\n```bash\neas build --platform ios --profile preview\neas build --platform android --profile preview\n```\n\n## Acceptance Criteria\n- [ ] eas.json configured\n- [ ] iOS build succeeds\n- [ ] Android build succeeds\n- [ ] Can install on physical devices","status":"open","priority":2,"issue_type":"task","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-01-30T18:46:53.334101808+05:30","created_by":"krot","updated_at":"2026-01-30T18:46:53.334101808+05:30","labels":["build","distribution","setup"],"dependencies":[{"issue_id":"kanji-reader-xwj.1.6","depends_on_id":"kanji-reader-xwj.1","type":"parent-child","created_at":"2026-01-30T18:46:53.335241657+05:30","created_by":"krot"},{"issue_id":"kanji-reader-xwj.1.6","depends_on_id":"kanji-reader-xwj.1.1","type":"blocks","created_at":"2026-01-30T18:47:00.860544844+05:30","created_by":"krot"}]}
{"id":"kanji-reader-xwj.2","title":"Phase 2: Camera \u0026 Image Input","description":"# Phase 2: Camera \u0026 Image Input\n\n## Purpose\nEnable two primary input methods for capturing Japanese text:\n1. Live camera capture\n2. Image upload from gallery (for screenshots)\n\n## Why Two Methods\n- Camera: For reading books, menus, signs in real-time\n- Upload: For TV/anime screenshots, saved images\n\n## Key Decisions Made\n- NO complex region selection in MVP (deferred to v2)\n- Optional guide frame for visual alignment\n- Full image capture - Google Vision is smart enough to find text\n- Image resizing before OCR (max 1920px) for performance/cost\n\n## Deliverables\n1. CameraScreen with live preview\n2. Permission handling (camera, media library)\n3. Capture button with feedback\n4. Optional guide frame overlay\n5. UploadScreen with gallery picker\n6. Image preview before processing\n7. Image resize/optimization utility\n\n## Technical Notes\n- expo-camera for camera access\n- expo-image-picker for gallery\n- expo-image-manipulator for resize/crop\n\n## Dependencies\nRequires Phase 1 complete (project setup, base components)\n\n## Acceptance Criteria\n- [ ] Camera permission requested and handled\n- [ ] Live preview displays correctly\n- [ ] Capture takes clear photo\n- [ ] Gallery picker works\n- [ ] Large images resized automatically\n- [ ] Navigation between camera/upload tabs","status":"open","priority":1,"issue_type":"feature","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-01-30T18:47:40.365724652+05:30","created_by":"krot","updated_at":"2026-01-30T18:47:40.365724652+05:30","labels":["camera","input","phase"],"dependencies":[{"issue_id":"kanji-reader-xwj.2","depends_on_id":"kanji-reader-xwj","type":"parent-child","created_at":"2026-01-30T18:47:40.366756999+05:30","created_by":"krot"},{"issue_id":"kanji-reader-xwj.2","depends_on_id":"kanji-reader-xwj.1","type":"blocks","created_at":"2026-01-30T18:47:40.369175851+05:30","created_by":"krot"}]}
{"id":"kanji-reader-xwj.2.1","title":"Implement Camera Screen","description":"# Camera Screen Implementation\n\n## Task\nBuild the main camera interface for capturing Japanese text.\n\n## Components\n```\nsrc/screens/CameraScreen.tsx\nsrc/components/CaptureButton.tsx\nsrc/components/GuideFrame.tsx (optional)\n```\n\n## Packages\n```bash\npnpm add expo-camera\n```\n\n## UI Layout\n```\n┌─────────────────────────┐\n│  [Flash]        [Guide] │  Header controls\n├─────────────────────────┤\n│                         │\n│     Camera Preview      │  Full screen\n│                         │\n│   ┌───────────────┐    │  Optional guide\n│   │   Align text  │    │  frame\n│   │     here      │    │\n│   └───────────────┘    │\n│                         │\n├─────────────────────────┤\n│  [Gallery]   [●]        │  Bottom bar\n│              Capture    │\n└─────────────────────────┘\n```\n\n## Permission Flow\n1. Check camera permission on mount\n2. If not granted, show request screen\n3. If denied, show settings link + upload fallback\n\n## Implementation Notes\n- Use expo-camera Camera component\n- CameraType.back by default\n- takePictureAsync with quality: 0.8\n- Haptic feedback on capture\n\n## Acceptance Criteria\n- [ ] Camera preview renders full-screen\n- [ ] Permission request shows on first use\n- [ ] Denied permission shows fallback UI\n- [ ] Capture button takes photo\n- [ ] Flash toggle works\n- [ ] Guide frame toggles on/off\n- [ ] Gallery button navigates to upload","status":"open","priority":1,"issue_type":"task","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-01-30T18:47:51.727123639+05:30","created_by":"krot","updated_at":"2026-01-30T18:47:51.727123639+05:30","labels":["camera","permissions","ui"],"dependencies":[{"issue_id":"kanji-reader-xwj.2.1","depends_on_id":"kanji-reader-xwj.2","type":"parent-child","created_at":"2026-01-30T18:47:51.728269494+05:30","created_by":"krot"},{"issue_id":"kanji-reader-xwj.2.1","depends_on_id":"kanji-reader-xwj.2.4","type":"blocks","created_at":"2026-01-30T18:48:28.933868166+05:30","created_by":"krot"}]}
{"id":"kanji-reader-xwj.2.2","title":"Implement Image Upload Screen","description":"# Image Upload Screen\n\n## Task\nBuild gallery picker for uploading screenshots/photos.\n\n## Primary Use Case\nUser pauses anime/drama, screenshots Japanese subtitles, uploads to learn.\n\n## Components\n```\nsrc/screens/UploadScreen.tsx\nsrc/components/ImagePreview.tsx\n```\n\n## Packages\n```bash\npnpm add expo-image-picker\n```\n\n## UI Layout\n```\n┌─────────────────────────┐\n│       Upload Image      │\n├─────────────────────────┤\n│                         │\n│   ┌─────────────────┐  │\n│   │                 │  │\n│   │   Tap to        │  │  Upload zone\n│   │   select image  │  │\n│   │                 │  │\n│   └─────────────────┘  │\n│                         │\n│   [Select from Gallery] │  Primary button\n│                         │\n├─────────────────────────┤\n│       [Use Camera]      │  Switch to camera\n└─────────────────────────┘\n```\n\n## After Selection - Preview\n```\n┌─────────────────────────┐\n│   Preview              X│\n├─────────────────────────┤\n│  ┌───────────────────┐ │\n│  │                   │ │\n│  │   Selected Image  │ │\n│  │                   │ │\n│  └───────────────────┘ │\n├─────────────────────────┤\n│  [Cancel]  [Scan Text]  │\n└─────────────────────────┘\n```\n\n## Implementation\n```typescript\nconst result = await ImagePicker.launchImageLibraryAsync({\n  mediaTypes: ImagePicker.MediaTypeOptions.Images,\n  quality: 0.8,\n});\n```\n\n## Acceptance Criteria\n- [ ] Gallery picker opens\n- [ ] Selected image shows in preview\n- [ ] Cancel returns to selection\n- [ ] Scan Text proceeds to OCR\n- [ ] Handles picker cancellation gracefully","status":"open","priority":1,"issue_type":"task","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-01-30T18:48:02.849307121+05:30","created_by":"krot","updated_at":"2026-01-30T18:48:02.849307121+05:30","labels":["gallery","ui","upload"],"dependencies":[{"issue_id":"kanji-reader-xwj.2.2","depends_on_id":"kanji-reader-xwj.2","type":"parent-child","created_at":"2026-01-30T18:48:02.850808416+05:30","created_by":"krot"},{"issue_id":"kanji-reader-xwj.2.2","depends_on_id":"kanji-reader-xwj.2.4","type":"blocks","created_at":"2026-01-30T18:48:28.972995631+05:30","created_by":"krot"}]}
{"id":"kanji-reader-xwj.2.3","title":"Create Image Processing Utility","description":"# Image Processing Utility\n\n## Task\nBuild utility for preparing images before OCR.\n\n## Why Needed\n- Large images = slower OCR + higher API costs\n- Orientation issues on some devices\n- Consistent format for API\n\n## File\n```\nsrc/services/image/index.ts\n```\n\n## Package\n```bash\npnpm add expo-image-manipulator\n```\n\n## Functions\n```typescript\ninterface ImageService {\n  // Resize if larger than maxDimension\n  resize(uri: string, maxDimension?: number): Promise\u003cstring\u003e;\n  \n  // Convert to base64 for API\n  toBase64(uri: string): Promise\u003cstring\u003e;\n  \n  // Get image dimensions\n  getDimensions(uri: string): Promise\u003c{width: number, height: number}\u003e;\n}\n```\n\n## Configuration\n- MAX_DIMENSION = 1920 (pixels)\n- OUTPUT_FORMAT = JPEG\n- QUALITY = 0.8\n\n## Resize Logic\n```typescript\nasync function resize(uri: string, maxDim = 1920): Promise\u003cstring\u003e {\n  const { width, height } = await getDimensions(uri);\n  \n  if (width \u003c= maxDim \u0026\u0026 height \u003c= maxDim) {\n    return uri; // No resize needed\n  }\n  \n  const scale = maxDim / Math.max(width, height);\n  \n  const result = await ImageManipulator.manipulateAsync(\n    uri,\n    [{ resize: { width: width * scale, height: height * scale } }],\n    { format: SaveFormat.JPEG, compress: 0.8 }\n  );\n  \n  return result.uri;\n}\n```\n\n## Acceptance Criteria\n- [ ] Large images resized correctly\n- [ ] Small images unchanged\n- [ ] Base64 conversion works\n- [ ] Handles rotation/orientation\n- [ ] TypeScript types exported","status":"open","priority":2,"issue_type":"task","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-01-30T18:48:13.272003757+05:30","created_by":"krot","updated_at":"2026-01-30T18:48:13.272003757+05:30","labels":["image","processing","utility"],"dependencies":[{"issue_id":"kanji-reader-xwj.2.3","depends_on_id":"kanji-reader-xwj.2","type":"parent-child","created_at":"2026-01-30T18:48:13.273113231+05:30","created_by":"krot"},{"issue_id":"kanji-reader-xwj.2.3","depends_on_id":"kanji-reader-xwj.2.1","type":"blocks","created_at":"2026-01-30T18:48:29.012444682+05:30","created_by":"krot"}]}
{"id":"kanji-reader-xwj.2.4","title":"Set up Navigation Structure","description":"# Navigation Structure\n\n## Task\nConfigure React Navigation for app flow.\n\n## Packages\n```bash\npnpm add @react-navigation/native @react-navigation/bottom-tabs @react-navigation/stack\npnpm add react-native-screens react-native-safe-area-context\n```\n\n## Navigation Structure\n```\nRootStack (Stack Navigator)\n├── MainTabs (Bottom Tab Navigator)\n│   ├── CameraTab → CameraScreen\n│   └── UploadTab → UploadScreen\n└── ResultsScreen (modal presentation)\n```\n\n## Files\n```\nsrc/navigation/\n├── index.tsx           # Root navigator\n├── MainTabs.tsx        # Bottom tabs\n├── types.ts            # Navigation types\n```\n\n## Type Safety\n```typescript\ntype RootStackParamList = {\n  MainTabs: undefined;\n  Results: {\n    imageUri: string;\n    // OCR result passed here\n  };\n};\n\ntype MainTabsParamList = {\n  Camera: undefined;\n  Upload: undefined;\n};\n```\n\n## Tab Icons\n- Camera: camera icon\n- Upload: image/photo icon\n\n## Flow\n1. App opens → Camera tab (default)\n2. Capture/upload → Navigate to Results (stack push)\n3. Scan Again → Pop back to tabs\n\n## Acceptance Criteria\n- [ ] Bottom tabs work\n- [ ] Camera is default tab\n- [ ] Results screen opens as modal\n- [ ] Back navigation works\n- [ ] TypeScript types for all screens","status":"open","priority":1,"issue_type":"task","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-01-30T18:48:24.081846511+05:30","created_by":"krot","updated_at":"2026-01-30T18:48:24.081846511+05:30","labels":["navigation","setup","ui"],"dependencies":[{"issue_id":"kanji-reader-xwj.2.4","depends_on_id":"kanji-reader-xwj.2","type":"parent-child","created_at":"2026-01-30T18:48:24.082966967+05:30","created_by":"krot"}]}
{"id":"kanji-reader-xwj.3","title":"Phase 3: OCR \u0026 Text Processing","description":"# Phase 3: OCR \u0026 Text Processing\n\n## Purpose\nExtract Japanese text from images using Google Cloud Vision API and segment into meaningful words.\n\n## Why Google Cloud Vision\n- High accuracy for Japanese (Kanji, Hiragana, Katakana)\n- Returns bounding boxes for text location\n- 1,000 free requests/month (sufficient for personal use)\n- Well-documented API\n\n## Key Components\n1. Google Cloud Vision API integration\n2. Character type detection (kanji/hiragana/katakana)\n3. Word segmentation (critical for meaning)\n4. State management for OCR results\n\n## Word Segmentation - Critical Decision\nJapanese has no spaces. 'にほんごをべんきょうする' must be split into:\n- にほんご (nihongo - Japanese language)\n- を (wo - particle)\n- べんきょう (benkyou - study)\n- する (suru - to do)\n\nWithout segmentation, dictionary lookup fails.\n\n## Libraries Considered\n- TinySegmenter: Small, fast, less accurate\n- Kuromoji: Accurate, but heavy\n- Budoux: Google's lightweight segmenter, good balance\n\nRecommendation: Budoux (lightweight, works in browser/RN)\n\n## Data Flow\n```\nImage → Resize → Base64 → Vision API → Raw Text\n  → Character Type Detection → Word Segmentation → Structured Result\n```\n\n## Dependencies\nRequires Phase 2 (image capture/processing)\n\n## Acceptance Criteria\n- [ ] Vision API returns text from Japanese image\n- [ ] Characters correctly classified by type\n- [ ] Text segmented into words\n- [ ] Bounding boxes available for overlay\n- [ ] Error handling for API failures","status":"open","priority":1,"issue_type":"feature","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-01-30T18:48:41.973550797+05:30","created_by":"krot","updated_at":"2026-01-30T18:48:41.973550797+05:30","labels":["ocr","phase","processing"],"dependencies":[{"issue_id":"kanji-reader-xwj.3","depends_on_id":"kanji-reader-xwj","type":"parent-child","created_at":"2026-01-30T18:48:41.974631817+05:30","created_by":"krot"},{"issue_id":"kanji-reader-xwj.3","depends_on_id":"kanji-reader-xwj.2","type":"blocks","created_at":"2026-01-30T18:48:41.977213409+05:30","created_by":"krot"}]}
{"id":"kanji-reader-xwj.3.1","title":"Implement Google Cloud Vision OCR Service","description":"# Google Cloud Vision OCR Service\n\n## Task\nIntegrate Google Cloud Vision API for Japanese text recognition.\n\n## File\n```\nsrc/services/ocr/cloudVision.ts\nsrc/services/ocr/types.ts\n```\n\n## API Endpoint\n```\nPOST https://vision.googleapis.com/v1/images:annotate?key=API_KEY\n```\n\n## Request Format\n```typescript\n{\n  requests: [{\n    image: { content: base64Image },\n    features: [\n      { type: 'TEXT_DETECTION' },\n      { type: 'DOCUMENT_TEXT_DETECTION' }\n    ],\n    imageContext: {\n      languageHints: ['ja', 'en']\n    }\n  }]\n}\n```\n\n## Response Parsing\nVision API returns:\n- fullTextAnnotation.text (complete extracted text)\n- textAnnotations[] (individual text blocks with bounding boxes)\n- pages[].blocks[].paragraphs[].words[].symbols[]\n\nWe need:\n1. Full text string\n2. Bounding boxes for text regions\n3. Confidence scores\n\n## Interface\n```typescript\ninterface OCRService {\n  recognizeText(imageUri: string): Promise\u003cOCRResult\u003e;\n}\n\ninterface OCRResult {\n  fullText: string;\n  blocks: TextBlock[];\n  confidence: number;\n}\n\ninterface TextBlock {\n  text: string;\n  boundingBox: BoundingBox;\n}\n```\n\n## Error Handling\n- Invalid API key → Clear error message\n- Rate limited → Retry with backoff\n- Network error → Offline message + retry\n- No text found → Empty result (not error)\n\n## Acceptance Criteria\n- [ ] API call succeeds with valid image\n- [ ] Japanese text extracted correctly\n- [ ] Bounding boxes parsed\n- [ ] Errors handled gracefully\n- [ ] Loading state during API call","status":"open","priority":1,"issue_type":"task","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-01-30T18:48:54.15637489+05:30","created_by":"krot","updated_at":"2026-01-30T18:48:54.15637489+05:30","labels":["api","google-cloud","ocr"],"dependencies":[{"issue_id":"kanji-reader-xwj.3.1","depends_on_id":"kanji-reader-xwj.3","type":"parent-child","created_at":"2026-01-30T18:48:54.157521646+05:30","created_by":"krot"}]}
{"id":"kanji-reader-xwj.3.2","title":"Create Character Type Detection Utility","description":"# Character Type Detection\n\n## Task\nDetect whether a character is Kanji, Hiragana, Katakana, or other.\n\n## Why Important\n- Color coding in UI (blue=kanji, green=hiragana, orange=katakana)\n- Different lookup strategies per type\n- Visual learning signal\n\n## File\n```\nsrc/utils/characterType.ts\n```\n\n## Unicode Ranges\n```typescript\ntype CharacterType = 'kanji' | 'hiragana' | 'katakana' | 'romaji' | 'punctuation' | 'other';\n\nfunction detectCharacterType(char: string): CharacterType {\n  const code = char.charCodeAt(0);\n  \n  // Hiragana: U+3040 - U+309F\n  if (code \u003e= 0x3040 \u0026\u0026 code \u003c= 0x309F) return 'hiragana';\n  \n  // Katakana: U+30A0 - U+30FF\n  if (code \u003e= 0x30A0 \u0026\u0026 code \u003c= 0x30FF) return 'katakana';\n  \n  // CJK Unified Ideographs (Kanji): U+4E00 - U+9FFF\n  if (code \u003e= 0x4E00 \u0026\u0026 code \u003c= 0x9FFF) return 'kanji';\n  \n  // Extended Kanji ranges\n  if (code \u003e= 0x3400 \u0026\u0026 code \u003c= 0x4DBF) return 'kanji'; // Extension A\n  if (code \u003e= 0xF900 \u0026\u0026 code \u003c= 0xFAFF) return 'kanji'; // Compatibility\n  \n  // Basic Latin letters\n  if ((code \u003e= 0x0041 \u0026\u0026 code \u003c= 0x005A) || \n      (code \u003e= 0x0061 \u0026\u0026 code \u003c= 0x007A)) return 'romaji';\n  \n  // Japanese punctuation\n  if ('。、！？「」『』（）・'.includes(char)) return 'punctuation';\n  \n  return 'other';\n}\n\n// For words, determine primary type\nfunction detectWordType(word: string): CharacterType {\n  const types = word.split('').map(detectCharacterType);\n  if (types.includes('kanji')) return 'kanji';\n  if (types.includes('katakana')) return 'katakana';\n  if (types.includes('hiragana')) return 'hiragana';\n  return types[0] || 'other';\n}\n```\n\n## Acceptance Criteria\n- [ ] Hiragana detected correctly (あいう)\n- [ ] Katakana detected correctly (アイウ)\n- [ ] Kanji detected correctly (日本語)\n- [ ] Mixed words classified by primary type\n- [ ] Unit tests pass","status":"open","priority":2,"issue_type":"task","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-01-30T18:49:08.016278856+05:30","created_by":"krot","updated_at":"2026-01-30T18:49:08.016278856+05:30","labels":["japanese","text","utility"],"dependencies":[{"issue_id":"kanji-reader-xwj.3.2","depends_on_id":"kanji-reader-xwj.3","type":"parent-child","created_at":"2026-01-30T18:49:08.017939785+05:30","created_by":"krot"}]}
{"id":"kanji-reader-xwj.3.3","title":"Implement Word Segmentation Service","description":"# Word Segmentation Service\n\n## Task\nSplit continuous Japanese text into meaningful words.\n\n## Why Critical\nJapanese has no spaces. Without segmentation:\n- '日本語を勉強する' looks like one blob\n- Dictionary lookup fails\n- Learning is impossible\n\nWith segmentation:\n- '日本語' 'を' '勉強' 'する' \n- Each word can be looked up\n- User learns actual vocabulary\n\n## Recommended Library: Budoux\n- By Google, specifically for line breaking / word segmentation\n- Lightweight (~10KB)\n- Works in browser/React Native\n- Good enough for learning purposes\n\n## Installation\n```bash\npnpm add budoux\n```\n\n## Implementation\n```typescript\n// src/services/segmentation/index.ts\nimport { loadDefaultJapaneseParser } from 'budoux';\n\nconst parser = loadDefaultJapaneseParser();\n\ninterface SegmentedWord {\n  text: string;\n  type: CharacterType;\n}\n\nfunction segmentText(text: string): SegmentedWord[] {\n  const segments = parser.parse(text);\n  \n  return segments.map(segment =\u003e ({\n    text: segment.trim(),\n    type: detectWordType(segment),\n  })).filter(s =\u003e s.text.length \u003e 0);\n}\n```\n\n## Edge Cases\n- Empty string → empty array\n- Only punctuation → filter out\n- Mixed Japanese/English → segment both\n- Numbers → keep as-is\n\n## Testing Examples\n| Input | Expected Segments |\n|-------|-------------------|\n| 日本語を勉強する | 日本語, を, 勉強, する |\n| こんにちは | こんにちは |\n| 東京タワー | 東京, タワー |\n\n## Acceptance Criteria\n- [ ] Budoux installed and working\n- [ ] Segments Japanese text correctly\n- [ ] Handles empty/edge cases\n- [ ] Returns typed SegmentedWord objects\n- [ ] Tests pass with example inputs","status":"open","priority":1,"issue_type":"task","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-01-30T18:49:19.361841318+05:30","created_by":"krot","updated_at":"2026-01-30T18:49:19.361841318+05:30","labels":["critical","japanese","segmentation"],"dependencies":[{"issue_id":"kanji-reader-xwj.3.3","depends_on_id":"kanji-reader-xwj.3","type":"parent-child","created_at":"2026-01-30T18:49:19.364087919+05:30","created_by":"krot"},{"issue_id":"kanji-reader-xwj.3.3","depends_on_id":"kanji-reader-xwj.3.2","type":"blocks","created_at":"2026-01-30T18:49:34.950466734+05:30","created_by":"krot"}]}
{"id":"kanji-reader-xwj.3.4","title":"Create OCR State Management","description":"# OCR State Management\n\n## Task\nCreate Zustand store for OCR workflow state.\n\n## File\n```\nsrc/store/ocrStore.ts\n```\n\n## State Shape\n```typescript\ninterface OCRState {\n  // Input\n  imageUri: string | null;\n  \n  // Processing\n  isProcessing: boolean;\n  error: string | null;\n  \n  // Results\n  rawText: string | null;\n  words: SegmentedWord[];\n  boundingBoxes: TextBlock[];\n  \n  // Actions\n  setImage: (uri: string) =\u003e void;\n  processImage: () =\u003e Promise\u003cvoid\u003e;\n  clearResults: () =\u003e void;\n  retry: () =\u003e Promise\u003cvoid\u003e;\n}\n```\n\n## Process Flow\n```typescript\nprocessImage: async () =\u003e {\n  set({ isProcessing: true, error: null });\n  \n  try {\n    // 1. Resize image\n    const resizedUri = await imageService.resize(get().imageUri);\n    \n    // 2. Call OCR\n    const ocrResult = await ocrService.recognizeText(resizedUri);\n    \n    // 3. Segment text\n    const words = segmentText(ocrResult.fullText);\n    \n    set({\n      rawText: ocrResult.fullText,\n      words,\n      boundingBoxes: ocrResult.blocks,\n      isProcessing: false,\n    });\n  } catch (error) {\n    set({ error: error.message, isProcessing: false });\n  }\n}\n```\n\n## Why Zustand\n- Simple API, minimal boilerplate\n- Works with React hooks naturally\n- Easy to understand (ADHD-friendly codebase)\n- Good TypeScript support\n\n## Acceptance Criteria\n- [ ] Store created with typed state\n- [ ] setImage updates imageUri\n- [ ] processImage orchestrates full flow\n- [ ] Error state captured and surfaced\n- [ ] clearResults resets state\n- [ ] retry re-runs processImage","status":"open","priority":2,"issue_type":"task","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-01-30T18:49:30.33928802+05:30","created_by":"krot","updated_at":"2026-01-30T18:49:30.33928802+05:30","labels":["ocr","state","zustand"],"dependencies":[{"issue_id":"kanji-reader-xwj.3.4","depends_on_id":"kanji-reader-xwj.3","type":"parent-child","created_at":"2026-01-30T18:49:30.340442139+05:30","created_by":"krot"},{"issue_id":"kanji-reader-xwj.3.4","depends_on_id":"kanji-reader-xwj.3.1","type":"blocks","created_at":"2026-01-30T18:49:34.990825728+05:30","created_by":"krot"},{"issue_id":"kanji-reader-xwj.3.4","depends_on_id":"kanji-reader-xwj.3.3","type":"blocks","created_at":"2026-01-30T18:49:35.030602136+05:30","created_by":"krot"}]}
{"id":"kanji-reader-xwj.4","title":"Phase 4: Dictionary Service","description":"# Phase 4: Dictionary Service\n\n## Purpose\nLook up readings and meanings for Japanese words using Jisho API.\n\n## Why Jisho\n- Free, no API key required\n- Good coverage of Japanese vocabulary\n- Returns readings, meanings, JLPT level\n- Unofficial but stable API\n\n## API Endpoint\nGET https://jisho.org/api/v1/search/words?keyword={word}\n\n## Key Features\n1. Word lookup → returns readings + meanings\n2. Romaji conversion using wanakana library\n3. Caching to reduce API calls\n4. Error handling for unknown words\n\n## Response Data We Need\n- word (日本語)\n- reading (にほんご)\n- romaji (nihongo) - converted locally\n- meanings (['Japanese language'])\n- jlptLevel (N5)\n- isCommon (true/false)\n\n## Caching Strategy\n- LRU cache (500 words)\n- AsyncStorage for persistence\n- Purpose: performance, NOT offline mode\n\n## Risk: Unofficial API\nJisho API is unofficial and could change. Mitigation:\n- Accept risk for MVP (it's been stable)\n- v2: Consider JMDict local database\n\n## Acceptance Criteria\n- [ ] Lookup returns correct data for common words\n- [ ] Romaji conversion works\n- [ ] Cache reduces repeat calls\n- [ ] Unknown words handled gracefully\n- [ ] Network errors don't crash app","status":"open","priority":1,"issue_type":"feature","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-01-30T18:49:53.126005681+05:30","created_by":"krot","updated_at":"2026-01-30T18:49:53.126005681+05:30","labels":["api","dictionary","phase"],"dependencies":[{"issue_id":"kanji-reader-xwj.4","depends_on_id":"kanji-reader-xwj","type":"parent-child","created_at":"2026-01-30T18:49:53.127162856+05:30","created_by":"krot"},{"issue_id":"kanji-reader-xwj.4","depends_on_id":"kanji-reader-xwj.3","type":"blocks","created_at":"2026-01-30T18:49:53.132364462+05:30","created_by":"krot"}]}
{"id":"kanji-reader-xwj.4.1","title":"Implement Jisho API Integration","description":"# Jisho API Integration\n\n## Task\nCreate dictionary service using Jisho.org API.\n\n## Files\n```\nsrc/services/dictionary/jisho.ts\nsrc/services/dictionary/types.ts\n```\n\n## API Request\n```typescript\nconst JISHO_API = 'https://jisho.org/api/v1/search/words';\n\nasync function lookup(word: string): Promise\u003cDictionaryEntry[]\u003e {\n  const response = await fetch(\n    `${JISHO_API}?keyword=${encodeURIComponent(word)}`\n  );\n  const data = await response.json();\n  return data.data.map(parseEntry);\n}\n```\n\n## Response Parsing\n```typescript\ninterface JishoEntry {\n  slug: string;\n  japanese: Array\u003c{\n    word?: string;\n    reading: string;\n  }\u003e;\n  senses: Array\u003c{\n    english_definitions: string[];\n    parts_of_speech: string[];\n  }\u003e;\n  is_common: boolean;\n  jlpt: string[];  // ['jlpt-n5']\n}\n\nfunction parseEntry(entry: JishoEntry): DictionaryEntry {\n  const jp = entry.japanese[0];\n  return {\n    word: jp.word || jp.reading,\n    reading: jp.reading,\n    meanings: entry.senses.flatMap(s =\u003e s.english_definitions),\n    partsOfSpeech: entry.senses.flatMap(s =\u003e s.parts_of_speech),\n    isCommon: entry.is_common,\n    jlptLevel: parseJlptLevel(entry.jlpt),\n  };\n}\n```\n\n## Error Handling\n- Network error → throw with message\n- Empty results → return empty array\n- Malformed response → return empty array with log\n\n## Acceptance Criteria\n- [ ] Lookup 日本語 returns correct data\n- [ ] Lookup unknown word returns empty\n- [ ] Network errors handled\n- [ ] TypeScript types complete","status":"open","priority":1,"issue_type":"task","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-01-30T18:50:04.60200436+05:30","created_by":"krot","updated_at":"2026-01-30T18:50:04.60200436+05:30","labels":["api","dictionary","jisho"],"dependencies":[{"issue_id":"kanji-reader-xwj.4.1","depends_on_id":"kanji-reader-xwj.4","type":"parent-child","created_at":"2026-01-30T18:50:04.603088655+05:30","created_by":"krot"}]}
{"id":"kanji-reader-xwj.4.2","title":"Implement Romaji Conversion","description":"# Romaji Conversion\n\n## Task\nConvert hiragana/katakana to romaji using wanakana library.\n\n## Why Needed\n- Dictionary returns reading in hiragana (にほんご)\n- Users need romaji to know pronunciation (nihongo)\n- wanakana is the standard library for this\n\n## Package\n```bash\npnpm add wanakana\n```\n\n## File\n```\nsrc/utils/romaji.ts\n```\n\n## Implementation\n```typescript\nimport { toRomaji, isJapanese, isHiragana, isKatakana } from 'wanakana';\n\nexport function convertToRomaji(text: string): string {\n  return toRomaji(text);\n}\n\n// Examples:\n// にほんご → nihongo\n// カタカナ → katakana\n// 日本語 → 日本語 (kanji unchanged)\n```\n\n## Notes\n- wanakana only converts kana, not kanji\n- Kanji passes through unchanged\n- Mixed text works (漢字かな → 漢字kana)\n\n## Acceptance Criteria\n- [ ] wanakana installed\n- [ ] Hiragana converts correctly\n- [ ] Katakana converts correctly\n- [ ] Kanji passes through\n- [ ] Empty string returns empty","status":"open","priority":2,"issue_type":"task","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-01-30T18:50:13.560761642+05:30","created_by":"krot","updated_at":"2026-01-30T18:50:13.560761642+05:30","labels":["japanese","romaji","utility"],"dependencies":[{"issue_id":"kanji-reader-xwj.4.2","depends_on_id":"kanji-reader-xwj.4","type":"parent-child","created_at":"2026-01-30T18:50:13.561853472+05:30","created_by":"krot"}]}
{"id":"kanji-reader-xwj.4.3","title":"Implement Dictionary Cache","description":"# Dictionary Cache\n\n## Task\nCache dictionary lookups to reduce API calls and improve performance.\n\n## File\n```\nsrc/services/dictionary/cache.ts\n```\n\n## Strategy\n- In-memory LRU cache (fast)\n- AsyncStorage backup (persistent)\n- Max 500 entries\n- NOT for offline mode - just performance\n\n## Implementation\n```typescript\nimport AsyncStorage from '@react-native-async-storage/async-storage';\n\nconst CACHE_KEY = 'dictionary_cache';\nconst MAX_ENTRIES = 500;\n\nclass DictionaryCache {\n  private memory: Map\u003cstring, DictionaryEntry[]\u003e = new Map();\n  \n  async get(word: string): Promise\u003cDictionaryEntry[] | null\u003e {\n    // Check memory first\n    if (this.memory.has(word)) {\n      return this.memory.get(word)!;\n    }\n    \n    // Check AsyncStorage\n    const stored = await AsyncStorage.getItem(`${CACHE_KEY}:${word}`);\n    if (stored) {\n      const entries = JSON.parse(stored);\n      this.memory.set(word, entries);\n      return entries;\n    }\n    \n    return null;\n  }\n  \n  async set(word: string, entries: DictionaryEntry[]): Promise\u003cvoid\u003e {\n    this.memory.set(word, entries);\n    \n    // Evict if over limit\n    if (this.memory.size \u003e MAX_ENTRIES) {\n      const firstKey = this.memory.keys().next().value;\n      this.memory.delete(firstKey);\n    }\n    \n    await AsyncStorage.setItem(`${CACHE_KEY}:${word}`, JSON.stringify(entries));\n  }\n}\n```\n\n## Acceptance Criteria\n- [ ] Cache hit returns data without API call\n- [ ] Cache miss fetches from API and stores\n- [ ] Memory cache works\n- [ ] AsyncStorage persistence works\n- [ ] Eviction when over limit","status":"open","priority":3,"issue_type":"task","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-01-30T18:50:22.704172349+05:30","created_by":"krot","updated_at":"2026-01-30T18:50:22.704172349+05:30","labels":["cache","dictionary","performance"],"dependencies":[{"issue_id":"kanji-reader-xwj.4.3","depends_on_id":"kanji-reader-xwj.4","type":"parent-child","created_at":"2026-01-30T18:50:22.705291591+05:30","created_by":"krot"}]}
{"id":"kanji-reader-xwj.5","title":"Phase 5: Text-to-Speech Service","description":"# Phase 5: Text-to-Speech Service\n\n## Purpose\nPronounce Japanese words aloud so users learn correct pronunciation.\n\n## Decision: Expo Speech (Primary)\nAfter consideration, we chose Expo Speech over Google Cloud TTS:\n- FREE (no API costs)\n- Works OFFLINE\n- No API key needed\n- Good enough quality for learning\n- Instant playback (no network latency)\n\nGoogle Cloud TTS deferred to v2 as premium option.\n\n## Key Features\n1. Tap word → hear pronunciation\n2. Handle rapid taps (stop previous, play new)\n3. Speed adjustment (0.5x - 2x)\n4. Japanese voice selection\n\n## Technical Notes\n- expo-speech package\n- Language: 'ja-JP'\n- Check voice availability on device\n- iOS and Android have different voices\n\n## Acceptance Criteria\n- [ ] Japanese words pronounced correctly\n- [ ] Rapid taps don't overlap\n- [ ] Speed adjustment works\n- [ ] Works offline\n- [ ] Error handling for missing voices","status":"open","priority":1,"issue_type":"feature","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-01-30T18:50:32.742603551+05:30","created_by":"krot","updated_at":"2026-01-30T18:50:32.742603551+05:30","labels":["audio","phase","tts"],"dependencies":[{"issue_id":"kanji-reader-xwj.5","depends_on_id":"kanji-reader-xwj","type":"parent-child","created_at":"2026-01-30T18:50:32.743666355+05:30","created_by":"krot"},{"issue_id":"kanji-reader-xwj.5","depends_on_id":"kanji-reader-xwj.4","type":"blocks","created_at":"2026-01-30T18:50:32.746307189+05:30","created_by":"krot"}]}
{"id":"kanji-reader-xwj.5.1","title":"Implement TTS Service with Expo Speech","description":"# TTS Service Implementation\n\n## Task\nCreate text-to-speech service using Expo Speech.\n\n## Package\n```bash\npnpm add expo-speech\n```\n\n## File\n```\nsrc/services/tts/index.ts\n```\n\n## Implementation\n```typescript\nimport * as Speech from 'expo-speech';\n\ninterface TTSOptions {\n  language?: string;\n  rate?: number;  // 0.5 - 2.0\n  pitch?: number;\n}\n\nconst defaultOptions: TTSOptions = {\n  language: 'ja-JP',\n  rate: 1.0,\n  pitch: 1.0,\n};\n\nexport const ttsService = {\n  async speak(text: string, options?: TTSOptions): Promise\u003cvoid\u003e {\n    // Stop any current speech (handles rapid taps)\n    Speech.stop();\n    \n    const opts = { ...defaultOptions, ...options };\n    \n    return new Promise((resolve, reject) =\u003e {\n      Speech.speak(text, {\n        language: opts.language,\n        rate: opts.rate,\n        pitch: opts.pitch,\n        onDone: () =\u003e resolve(),\n        onError: (error) =\u003e reject(error),\n      });\n    });\n  },\n  \n  stop(): void {\n    Speech.stop();\n  },\n  \n  async isJapaneseAvailable(): Promise\u003cboolean\u003e {\n    const voices = await Speech.getAvailableVoicesAsync();\n    return voices.some(v =\u003e v.language.startsWith('ja'));\n  },\n};\n```\n\n## Rapid Tap Handling\nThe key insight: call Speech.stop() BEFORE starting new speech.\nThis prevents overlapping audio.\n\n## Testing\n- Test on both iOS and Android\n- iOS: Uses Siri voices\n- Android: Uses Google TTS (may need download)\n\n## Acceptance Criteria\n- [ ] Japanese text pronounced\n- [ ] Rapid taps don't overlap\n- [ ] stop() works\n- [ ] Voice availability check works\n- [ ] Rate adjustment works","status":"open","priority":1,"issue_type":"task","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-01-30T18:50:43.299406973+05:30","created_by":"krot","updated_at":"2026-01-30T18:50:43.299406973+05:30","labels":["audio","expo-speech","tts"],"dependencies":[{"issue_id":"kanji-reader-xwj.5.1","depends_on_id":"kanji-reader-xwj.5","type":"parent-child","created_at":"2026-01-30T18:50:43.300480547+05:30","created_by":"krot"}]}
{"id":"kanji-reader-xwj.6","title":"Phase 6: Results Display","description":"# Phase 6: Results Display\n\n## Purpose\nThe core learning interface. Display scanned text and let users interact with words.\n\n## Key Decisions (from review)\n1. Show FULL TEXT first - user sees complete sentence\n2. Word-level cards (not character-level) - kanji meanings change with words\n3. Tap word → play pronunciation + show details\n4. Color-coded by type (kanji=blue, hiragana=green, katakana=orange)\n\n## Screen Layout\n```\n┌─────────────────────────────┐\n│  ← Back       Results       │\n├─────────────────────────────┤\n│  [Scanned Image Thumbnail]  │\n├─────────────────────────────┤\n│  Full text:                 │\n│  「日本語を勉強する」        │  ← Complete sentence\n├─────────────────────────────┤\n│  Words: (tap to learn)      │\n│  ┌──────┐ ┌──┐ ┌────┐     │\n│  │日本語│ │を│ │勉強│     │  ← Word cards\n│  │nihongo│ │o │ │benkyō│   │\n│  └──────┘ └──┘ └────┘     │\n├─────────────────────────────┤\n│       [Scan Again]          │\n└─────────────────────────────┘\n```\n\n## Components Needed\n1. ResultsScreen - main container\n2. WordCard - tappable word display\n3. DetailPanel - bottom sheet with full info\n\n## Interactions\n- Tap word → TTS plays + Detail panel opens\n- Swipe panel down → dismiss\n- Scan Again → back to camera\n\n## Acceptance Criteria\n- [ ] Full text displayed\n- [ ] Words shown as tappable cards\n- [ ] Tap plays pronunciation\n- [ ] Detail panel shows meaning\n- [ ] Color coding correct\n- [ ] Scan Again works","status":"open","priority":1,"issue_type":"feature","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-01-30T18:50:56.744083514+05:30","created_by":"krot","updated_at":"2026-01-30T18:50:56.744083514+05:30","labels":["display","phase","ui"],"dependencies":[{"issue_id":"kanji-reader-xwj.6","depends_on_id":"kanji-reader-xwj","type":"parent-child","created_at":"2026-01-30T18:50:56.74516295+05:30","created_by":"krot"},{"issue_id":"kanji-reader-xwj.6","depends_on_id":"kanji-reader-xwj.5","type":"blocks","created_at":"2026-01-30T18:50:56.7479536+05:30","created_by":"krot"}]}
{"id":"kanji-reader-xwj.6.1","title":"Implement Results Screen","description":"# Results Screen\n\n## Task\nBuild the main results display screen.\n\n## File\n```\nsrc/screens/ResultsScreen.tsx\n```\n\n## Props (from navigation)\n```typescript\ninterface ResultsScreenProps {\n  route: {\n    params: {\n      imageUri: string;\n    };\n  };\n}\n```\n\n## Layout Implementation\n```typescript\n\u003cSafeAreaView style={styles.container}\u003e\n  {/* Header */}\n  \u003cView style={styles.header}\u003e\n    \u003cBackButton /\u003e\n    \u003cText style={styles.title}\u003eResults\u003c/Text\u003e\n  \u003c/View\u003e\n  \n  {/* Image thumbnail */}\n  \u003cImage source={{ uri: imageUri }} style={styles.thumbnail} /\u003e\n  \n  {/* Full text */}\n  \u003cView style={styles.fullTextContainer}\u003e\n    \u003cText style={styles.label}\u003eFull text:\u003c/Text\u003e\n    \u003cText style={styles.fullText}\u003e{rawText}\u003c/Text\u003e\n  \u003c/View\u003e\n  \n  {/* Word cards */}\n  \u003cText style={styles.label}\u003eWords: (tap to learn)\u003c/Text\u003e\n  \u003cScrollView horizontal style={styles.wordList}\u003e\n    {words.map((word, index) =\u003e (\n      \u003cWordCard \n        key={index}\n        word={word}\n        onPress={() =\u003e handleWordPress(word)}\n        isSelected={selectedWord?.text === word.text}\n      /\u003e\n    ))}\n  \u003c/ScrollView\u003e\n  \n  {/* Detail panel */}\n  {selectedWord \u0026\u0026 (\n    \u003cDetailPanel \n      word={selectedWord}\n      entry={dictionaryEntry}\n      onClose={() =\u003e setSelectedWord(null)}\n    /\u003e\n  )}\n  \n  {/* Scan Again */}\n  \u003cButton title='Scan Again' onPress={handleScanAgain} /\u003e\n\u003c/SafeAreaView\u003e\n```\n\n## State\n- selectedWord: current word being viewed\n- dictionaryEntry: loaded from dictionary service\n- isLoadingEntry: dictionary lookup in progress\n\n## Acceptance Criteria\n- [ ] Screen renders without crash\n- [ ] Image thumbnail visible\n- [ ] Full text displayed\n- [ ] Word cards scroll horizontally\n- [ ] Scan Again navigates back","status":"open","priority":1,"issue_type":"task","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-01-30T18:51:06.466261484+05:30","created_by":"krot","updated_at":"2026-01-30T18:51:06.466261484+05:30","labels":["results","screen","ui"],"dependencies":[{"issue_id":"kanji-reader-xwj.6.1","depends_on_id":"kanji-reader-xwj.6","type":"parent-child","created_at":"2026-01-30T18:51:06.467395173+05:30","created_by":"krot"}]}
{"id":"kanji-reader-xwj.6.2","title":"Create WordCard Component","description":"# WordCard Component\n\n## Task\nCreate tappable card component for displaying Japanese words.\n\n## File\n```\nsrc/components/WordCard.tsx\n```\n\n## Props\n```typescript\ninterface WordCardProps {\n  word: SegmentedWord;\n  romaji?: string;\n  onPress: () =\u003e void;\n  isSelected: boolean;\n}\n```\n\n## Visual Design\n```\n┌─────────────┐\n│   日本語    │  ← Word (large, 20-24pt)\n│   nihongo   │  ← Romaji (small, muted)\n│      ●      │  ← Type indicator dot\n└─────────────┘\n```\n\n## Styling\n- Background: surface color\n- Border: subtle gray\n- Selected: primary color border, elevated shadow\n- Type indicator:\n  - Blue dot = kanji\n  - Green dot = hiragana\n  - Orange dot = katakana\n\n## Implementation\n```typescript\nconst typeColors = {\n  kanji: colors.kanji,      // blue\n  hiragana: colors.hiragana, // green\n  katakana: colors.katakana, // orange\n  mixed: colors.kanji,\n};\n\n\u003cPressable \n  style={[styles.card, isSelected \u0026\u0026 styles.selected]}\n  onPress={onPress}\n\u003e\n  \u003cText style={styles.word}\u003e{word.text}\u003c/Text\u003e\n  {romaji \u0026\u0026 \u003cText style={styles.romaji}\u003e{romaji}\u003c/Text\u003e}\n  \u003cView style={[styles.dot, { backgroundColor: typeColors[word.type] }]} /\u003e\n\u003c/Pressable\u003e\n```\n\n## Accessibility\n- Minimum touch target: 44x44\n- Haptic feedback on press\n- VoiceOver: announces word\n\n## Acceptance Criteria\n- [ ] Card renders correctly\n- [ ] Press handler fires\n- [ ] Selected state visible\n- [ ] Color coding by type\n- [ ] Haptic feedback works","status":"open","priority":1,"issue_type":"task","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-01-30T18:51:17.020481098+05:30","created_by":"krot","updated_at":"2026-01-30T18:51:17.020481098+05:30","labels":["component","ui","word-card"],"dependencies":[{"issue_id":"kanji-reader-xwj.6.2","depends_on_id":"kanji-reader-xwj.6","type":"parent-child","created_at":"2026-01-30T18:51:17.021529774+05:30","created_by":"krot"}]}
{"id":"kanji-reader-xwj.6.3","title":"Create DetailPanel Component","description":"# DetailPanel Component (Bottom Sheet)\n\n## Task\nCreate bottom sheet that shows full word details.\n\n## File\n```\nsrc/components/DetailPanel.tsx\n```\n\n## Recommended Package\n```bash\npnpm add @gorhom/bottom-sheet\n```\n\n## Props\n```typescript\ninterface DetailPanelProps {\n  word: SegmentedWord;\n  entry: DictionaryEntry | null;\n  isLoading: boolean;\n  onClose: () =\u003e void;\n  onPlayAudio: () =\u003e void;\n}\n```\n\n## Layout\n```\n┌─────────────────────────────┐\n│  ━━━━━  (drag handle)       │\n├─────────────────────────────┤\n│  日本語              🔊     │  Word + audio button\n│  にほんご (nihongo)         │  Reading + romaji\n├─────────────────────────────┤\n│  Meanings:                  │\n│  • Japanese language        │\n│  • Japanese                 │\n├─────────────────────────────┤\n│  JLPT N5  •  Common        │  Metadata badges\n└─────────────────────────────┘\n```\n\n## States\n1. Loading - shimmer placeholder\n2. Loaded - full content\n3. Not Found - 'No dictionary entry'\n4. Error - 'Couldn't load meaning' + retry\n\n## Interactions\n- Swipe down → dismiss\n- Tap outside → dismiss\n- Tap audio button → play TTS\n- Tap anywhere else → nothing\n\n## Implementation Notes\n- Use @gorhom/bottom-sheet for smooth animations\n- snapPoints: ['40%']\n- Handle keyboard if adding features later\n\n## Acceptance Criteria\n- [ ] Panel slides up smoothly\n- [ ] Word and reading displayed\n- [ ] Meanings listed\n- [ ] Audio button plays TTS\n- [ ] Swipe/tap to dismiss works\n- [ ] Loading state shows shimmer\n- [ ] Handles missing dictionary entry","status":"open","priority":1,"issue_type":"task","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-01-30T18:51:29.51521802+05:30","created_by":"krot","updated_at":"2026-01-30T18:51:29.51521802+05:30","labels":["bottom-sheet","component","ui"],"dependencies":[{"issue_id":"kanji-reader-xwj.6.3","depends_on_id":"kanji-reader-xwj.6","type":"parent-child","created_at":"2026-01-30T18:51:29.516544448+05:30","created_by":"krot"}]}
{"id":"kanji-reader-xwj.7","title":"Phase 7: Integration \u0026 Polish","description":"# Phase 7: Integration \u0026 Polish\n\n## Purpose\nConnect all components, test end-to-end flow, and polish the experience.\n\n## End-to-End Flow\n```\n1. Open app → Camera screen\n2. Capture image → Loading...\n3. OCR processes → Segments text\n4. Navigate to Results → See full text + words\n5. Tap word → TTS plays + Detail panel\n6. Learn meaning → Tap another word\n7. Scan Again → Back to camera\n```\n\n## Integration Points\n- Camera → Image Service → OCR Service\n- OCR → Segmentation → OCR Store\n- Results Screen → Dictionary Service → TTS Service\n- Navigation flow between all screens\n\n## Polish Tasks\n- Loading animations (not jarring)\n- Smooth transitions\n- Empty states (no text found)\n- Error states with retry\n- Haptic feedback throughout\n\n## ADHD-Friendly Checks\n- [ ] Quick interactions (no waiting)\n- [ ] Immediate feedback on tap\n- [ ] Clear visual states\n- [ ] No unnecessary steps\n\n## Acceptance Criteria\n- [ ] Full flow works on device\n- [ ] No crashes during flow\n- [ ] Errors handled gracefully\n- [ ] Performance acceptable (\u003c3s OCR)\n- [ ] Feels polished and responsive","status":"open","priority":1,"issue_type":"feature","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-01-30T18:51:39.489363269+05:30","created_by":"krot","updated_at":"2026-01-30T18:51:39.489363269+05:30","labels":["integration","phase","polish"],"dependencies":[{"issue_id":"kanji-reader-xwj.7","depends_on_id":"kanji-reader-xwj","type":"parent-child","created_at":"2026-01-30T18:51:39.490503932+05:30","created_by":"krot"},{"issue_id":"kanji-reader-xwj.7","depends_on_id":"kanji-reader-xwj.6","type":"blocks","created_at":"2026-01-30T18:51:39.493410854+05:30","created_by":"krot"}]}
{"id":"kanji-reader-xwj.7.1","title":"Wire End-to-End Flow","description":"# Wire End-to-End Flow\n\n## Task\nConnect all services and screens into working flow.\n\n## Flow to Implement\n```\nCameraScreen\n  ├── onCapture(imageUri)\n  │   ├── imageService.resize(imageUri)\n  │   ├── ocrStore.setImage(resizedUri)\n  │   ├── ocrStore.processImage()\n  │   └── navigate('Results', { imageUri })\n  │\nResultsScreen\n  ├── useOCRStore() → { rawText, words }\n  ├── onWordPress(word)\n  │   ├── ttsService.speak(word.text)\n  │   ├── setSelectedWord(word)\n  │   └── dictionaryService.lookup(word.text)\n  │\n  └── onScanAgain()\n      ├── ocrStore.clearResults()\n      └── navigate('MainTabs')\n```\n\n## Files to Modify\n- src/screens/CameraScreen.tsx\n- src/screens/UploadScreen.tsx\n- src/screens/ResultsScreen.tsx\n\n## Testing Checklist\n- [ ] Camera capture → OCR → Results works\n- [ ] Upload → OCR → Results works\n- [ ] Tap word → TTS plays\n- [ ] Tap word → Dictionary loads\n- [ ] Scan Again → Returns to camera\n\n## Acceptance Criteria\n- [ ] Complete flow executable\n- [ ] No broken navigation\n- [ ] State persists correctly\n- [ ] Errors don't break flow","status":"open","priority":1,"issue_type":"task","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-01-30T18:51:49.442056607+05:30","created_by":"krot","updated_at":"2026-01-30T18:51:49.442056607+05:30","labels":["flow","integration","wiring"],"dependencies":[{"issue_id":"kanji-reader-xwj.7.1","depends_on_id":"kanji-reader-xwj.7","type":"parent-child","created_at":"2026-01-30T18:51:49.443216356+05:30","created_by":"krot"}]}
{"id":"kanji-reader-xwj.7.2","title":"Implement Error Handling","description":"# Error Handling\n\n## Task\nHandle all error cases gracefully.\n\n## Error Scenarios\n\n### Camera/Permission Errors\n- Permission denied → Show settings link + upload fallback\n- Camera unavailable → Show message + upload option\n\n### OCR Errors\n- Network error → 'Check connection' + Retry button\n- API error → 'Service unavailable' + Retry\n- No text found → 'No Japanese text detected' (not an error)\n\n### Dictionary Errors\n- Network error → Show word without meaning + Retry\n- Not found → 'No dictionary entry' (not an error)\n\n### TTS Errors\n- Voice unavailable → Silent fail, show visual only\n- Other errors → Silent fail, log for debugging\n\n## Error Display Pattern\n```\n┌─────────────────────────────┐\n│         ⚠️                  │\n│   Something went wrong      │\n│   [specific message]        │\n│                             │\n│   [Retry]    [Go Back]      │\n└─────────────────────────────┘\n```\n\n## Implementation\n- Use ErrorBoundary at root\n- Try-catch in all async operations\n- User-friendly messages (not technical)\n- Always offer a way forward\n\n## Acceptance Criteria\n- [ ] No unhandled crashes\n- [ ] All errors show friendly message\n- [ ] Retry option where appropriate\n- [ ] Errors logged for debugging","status":"open","priority":2,"issue_type":"task","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-01-30T18:51:59.864680383+05:30","created_by":"krot","updated_at":"2026-01-30T18:51:59.864680383+05:30","labels":["error-handling","reliability","ux"],"dependencies":[{"issue_id":"kanji-reader-xwj.7.2","depends_on_id":"kanji-reader-xwj.7","type":"parent-child","created_at":"2026-01-30T18:51:59.866281145+05:30","created_by":"krot"}]}
{"id":"kanji-reader-xwj.8","title":"Phase 8: Testing","description":"# Phase 8: Testing\n\n## Purpose\nVerify app works correctly through manual and automated testing.\n\n## Testing Strategy\n\n### Unit Tests (automated)\n- Utility functions (character type detection, romaji conversion)\n- Service functions (parse responses)\n- Zustand store actions\n\n### Component Tests (automated)\n- WordCard renders correctly\n- DetailPanel shows data\n- Base components work\n\n### Integration Tests (manual)\n- Full flow on iOS simulator\n- Full flow on Android emulator\n- Edge cases (no text, errors)\n\n### Device Testing (manual, critical)\n- Real iPhone\n- Real Android\n- Camera permissions\n- TTS voices\n\n## Test Files\n```\nsrc/utils/__tests__/characterType.test.ts\nsrc/utils/__tests__/romaji.test.ts\nsrc/services/__tests__/dictionary.test.ts\nsrc/components/__tests__/WordCard.test.tsx\n```\n\n## Tools\n- Jest (comes with Expo)\n- React Native Testing Library\n\n## Acceptance Criteria\n- [ ] Unit tests pass\n- [ ] Component tests pass\n- [ ] Manual flow works on iOS\n- [ ] Manual flow works on Android\n- [ ] Device testing complete","status":"open","priority":2,"issue_type":"feature","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-01-30T18:52:08.573260685+05:30","created_by":"krot","updated_at":"2026-01-30T18:52:08.573260685+05:30","labels":["phase","quality","testing"],"dependencies":[{"issue_id":"kanji-reader-xwj.8","depends_on_id":"kanji-reader-xwj","type":"parent-child","created_at":"2026-01-30T18:52:08.574327637+05:30","created_by":"krot"},{"issue_id":"kanji-reader-xwj.8","depends_on_id":"kanji-reader-xwj.7","type":"blocks","created_at":"2026-01-30T18:52:08.585919254+05:30","created_by":"krot"}]}
{"id":"kanji-reader-xwj.9","title":"Phase 9: Build \u0026 Install","description":"# Phase 9: Build \u0026 Install\n\n## Purpose\nBuild installable apps for iOS and Android for local distribution.\n\n## iOS Build \u0026 Install\n\n### Prerequisites\n- Apple Developer account ($99/year)\n- Physical iPhone\n- Device UDID registered\n\n### Steps\n```bash\n# Build for iOS\neas build --platform ios --profile preview\n\n# After build completes, download .ipa from EAS dashboard\n# Install via:\n# - Apple Configurator 2 (Mac)\n# - Diawi.com (upload .ipa, scan QR)\n# - TestFlight (if you prefer)\n```\n\n## Android Build \u0026 Install\n\n### Prerequisites\n- No account needed for .apk\n- Physical Android device\n- 'Unknown sources' enabled\n\n### Steps\n```bash\n# Build for Android\neas build --platform android --profile preview\n\n# Download .apk from EAS dashboard\n# Transfer to device (ADB, cloud, cable)\n# Install by opening .apk\n```\n\n## Final Checklist\n- [ ] iOS .ipa built successfully\n- [ ] iOS installed on physical iPhone\n- [ ] Android .apk built successfully\n- [ ] Android installed on physical device\n- [ ] Full flow works on both platforms\n\n## Documentation\n- Build commands in README\n- API key setup instructions\n- Known limitations documented\n\n## MVP Complete When\n- App runs on Avinash's iPhone\n- Japanese text can be scanned\n- Words can be pronounced\n- Meanings can be looked up","status":"open","priority":2,"issue_type":"feature","owner":"8983708+avinash-lodhi@users.noreply.github.com","created_at":"2026-01-30T18:52:19.047729991+05:30","created_by":"krot","updated_at":"2026-01-30T18:52:19.047729991+05:30","labels":["build","distribution","phase"],"dependencies":[{"issue_id":"kanji-reader-xwj.9","depends_on_id":"kanji-reader-xwj","type":"parent-child","created_at":"2026-01-30T18:52:19.049272512+05:30","created_by":"krot"},{"issue_id":"kanji-reader-xwj.9","depends_on_id":"kanji-reader-xwj.8","type":"blocks","created_at":"2026-01-30T18:52:19.053758434+05:30","created_by":"krot"}]}
